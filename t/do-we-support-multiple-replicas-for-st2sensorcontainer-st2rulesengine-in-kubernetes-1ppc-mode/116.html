<!DOCTYPE html>
<html lang="en" class="desktop-view not-mobile-device text-size-normal anon">
<head>
    <meta charset="utf-8">
    <title>Do we support multiple replicas for st2sensorcontainer, st2rulesengine in kubernetes-1ppc mode? - Platform -
        StackStorm Support (ARCHIVED)</title>
    <meta name="description" content="Hi Team, 
I deployed st2 using kubernetes-1ppc mode 
I saw all the replicas in the st2.yml are all set to 1 
like  st2sensorcontainer 

 
I went through our ha doc and found some st2 comps need to take extra work to achi&amp;hellip;">
    <meta name="discourse_theme_id" content="2">
    <meta name="discourse_current_homepage" content="latest">
    <meta name="generator"
          content="Discourse 2.8.0.beta6 - https://github.com/discourse/discourse version a1daf9fe53a66e2d2cdf9757ab4812fb9a2b2787">
    <link rel="icon" type="image/png"
          href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/379ced12f8326d58f1b3d2b3ff652f883e141f6a_2_32x32.PNG">
    <link rel="apple-touch-icon" type="image/png"
          href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/379ced12f8326d58f1b3d2b3ff652f883e141f6a_2_180x180.PNG">
    <meta name="theme-color" content="#ffffff">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <link rel="canonical" href="116.html"/>
    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "https://forum.stackstorm.com",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://forum.stackstorm.com/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    <link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml"
          title="StackStorm Support (ARCHIVED) Search">


    <link href="/../../stylesheets/color_definitions_base__2_3c5eec1ecf192052ea70b4afdab57a62bccc0604.css?__ws=forum.stackstorm.com"
          media="all" rel="stylesheet" class="light-scheme"/>

    <link href="/../../stylesheets/desktop_b2f2968742d41481357e0df259b51ce29f72481a.css?__ws=forum.stackstorm.com"
          media="all" rel="stylesheet" data-target="desktop"/>


    <meta name="fragment" content="!">


    <link id="manifest-link" rel="manifest" href="../../manifest.webmanifest" crossorigin="use-credentials">


    <link rel="alternate" type="application/rss+xml"
          title="RSS feed of &#39;Do we support multiple replicas for st2sensorcontainer, st2rulesengine in kubernetes-1ppc mode?&#39;"
          href="116.rss"/>
    <meta property="og:site_name" content="StackStorm Support (ARCHIVED)"/>
    <meta property="og:type" content="website"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image"
          content="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/891f00fbdb31fecb5bd9dab30c186d2fed0091ca.jpeg"/>
    <meta property="og:image"
          content="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/891f00fbdb31fecb5bd9dab30c186d2fed0091ca.jpeg"/>
    <meta property="og:url"
          content="https://forum.stackstorm.com/t/do-we-support-multiple-replicas-for-st2sensorcontainer-st2rulesengine-in-kubernetes-1ppc-mode/116"/>
    <meta name="twitter:url"
          content="https://forum.stackstorm.com/t/do-we-support-multiple-replicas-for-st2sensorcontainer-st2rulesengine-in-kubernetes-1ppc-mode/116"/>
    <meta property="og:title"
          content="Do we support multiple replicas for st2sensorcontainer, st2rulesengine in kubernetes-1ppc mode?"/>
    <meta name="twitter:title"
          content="Do we support multiple replicas for st2sensorcontainer, st2rulesengine in kubernetes-1ppc mode?"/>
    <meta property="og:description"
          content="Hi Team,  I deployed st2 using kubernetes-1ppc mode  I saw all the replicas in the st2.yml are all set to 1  like  st2sensorcontainer      I went through our ha doc and found some st2 comps need to take extra work to achieve HA(like st2rulesengine need to disable the timer,  st2sensorcontainer need to consider partitioning sensors)  https://docs.stackstorm.com/reference/ha.html  My question is do we support multi-replicas? expecially for st2sensorcontainer,st2rulesengine, these comps.  Any extra..."/>
    <meta name="twitter:description"
          content="Hi Team,  I deployed st2 using kubernetes-1ppc mode  I saw all the replicas in the st2.yml are all set to 1  like  st2sensorcontainer      I went through our ha doc and found some st2 comps need to take extra work to achieve HA(like st2rulesengine need to disable the timer,  st2sensorcontainer need to consider partitioning sensors)  https://docs.stackstorm.com/reference/ha.html  My question is do we support multi-replicas? expecially for st2sensorcontainer,st2rulesengine, these comps.  Any extra..."/>
    <meta property="article:published_time" content="2018-04-04T02:41:35+00:00"/>
    <meta property="og:ignore_canonical" content="true"/>


    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "QAPage",
        "name": "Do we support multiple replicas for st2sensorcontainer, st2rulesengine in kubernetes-1ppc mode?",
        "mainEntity": {
            "@type": "Question",
            "name": "Do we support multiple replicas for st2sensorcontainer, st2rulesengine in kubernetes-1ppc mode?",
            "text": "Hi Team,\n\nI deployed st2 using kubernetes-1ppc mode\n\nI saw all the replicas in the st2.yml are all set to 1\n\nlike  st2sensorcontainer\n\n<a href="
            https://forum.stackstorm.com/t/do-we-support-multiple-replicas-for-st2sensorcontainer-st2rulesengine-in-kubernetes-1ppc-mode/\&quot;https://github.com/StackStorm/st2-docker/blob/master/runtime/kubernetes-1ppc/st2.yml#L128\"" target=\"_blank\" rel=\"nofollow noopener\">StackStorm/st2-docker/blob/master/runtime/kubernetes-1ppc/st2.yml#L128<\/a>\n\nports:\n\n- protocol: TCP\n\nport: 9102\n\n---\n\napiVersion: apps/v1beta1\n\nkind: Deployment\n\nm&hellip;","upvoteCount":0,"answerCount":1,"dateCreated":"2018-04-04T02:41:35.365Z","author":{"@type":"Person","name":"longfei.zhang"},"acceptedAnswer":{"@type":"Answer","text":"I run with following configurations and it worked for me\n\nreplicas:\n\nst2web: 3\n\nst2stream: 3\n\nst2sensorcontainer: 1\n\nst2rulesengine: 1\n\nst2resultstracker: 3\n\nst2notifier: 3\n\nst2garbagecollector: 1\n\nst2auth: 3\n\nst2api: 3\n\nst2actionrunner: 3\n\nmistralserver: 3\n\nmistralapi: 3","upvoteCount":0,"dateCreated":"2018-04-18T07:44:17.900Z","url":"https://forum.stackstorm.com/t/do-we-support-multiple-replicas-for-st2sensorcontainer-st2rulesengine-in-kubernetes-1ppc-mode/116/3","author":{"@type":"Person","name":"longfei"}}}}
    </script>

    <meta id="data-discourse-setup" data-cdn="https://sjc6.discourse-cdn.com/standard10"
          data-base-url="https://forum.stackstorm.com" data-base-uri="" data-environment="production"
          data-letter-avatar-version="5_8fec8e114563efeaf5265573e510f08e"
          data-markdown-it-url="https://aws1.discourse-cdn.com/standard10/assets/markdown-it-bundle-31e9a9c535ca1801c26da78b0ff465821751a98f921c5cdc5457d7e5a69e9748.js"
          data-service-worker-url="service-worker.js" data-default-locale="en"
          data-asset-version="597e36448c9b51d0fa3b7e43ec1fd6d5" data-disable-custom-css="false"
          data-highlight-js-path="/highlight-js/forum.stackstorm.com/ac0f4aa001e1343346941766d72e0c1ae330832b.js"
          data-svg-sprite-path="/svg-sprite/forum.stackstorm.com/svg-2-c2ad434b1e06079c7e282124aed9938dc95b83ea.js"
          data-enable-js-error-reporting="true" data-color-scheme-is-dark="false" data-user-dark-scheme-id="-1"
          data-s3-cdn="https://aws1.discourse-cdn.com/standard10"
          data-s3-base-url="//discourse-cloud-file-uploads.s3.dualstack.us-west-2.amazonaws.com/standard10">

    <meta name="discourse/config/environment"
          content="%7B%22modulePrefix%22%3A%22discourse%22%2C%22environment%22%3A%22production%22%2C%22rootURL%22%3A%22%22%2C%22locationType%22%3A%22auto%22%2C%22historySupportMiddleware%22%3Afalse%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%2C%22_APPLICATION_TEMPLATE_WRAPPER%22%3Afalse%2C%22_DEFAULT_ASYNC_OBSERVERS%22%3Atrue%2C%22_JQUERY_INTEGRATION%22%3Atrue%7D%2C%22APP%22%3A%7B%22name%22%3A%22discourse%22%2C%22version%22%3A%222.8.0.beta6%20a1daf9fe53a66e2d2cdf9757ab4812fb9a2b2787%22%2C%22exportApplicationGlobal%22%3Atrue%7D%7D"/>
</head>

<body class="">


<header class="d-header">
    <div class="wrap">
        <div class="contents clearfix">
            <div class="title">
                <a href="../../index.html">
                    <picture>
                        <img src="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png"
                             alt="StackStorm Support (ARCHIVED)" id="site-logo"/>
                    </picture>
                </a>
            </div>

        </div>
    </div>
</header>

<div id="main-outlet" class="wrap" role="main">
    <!-- preload-content: -->

    <!-- EOF START -->
    <div class="container" id="main-container">
        <div id="ember11" class="ember-view"></div>
        <div id="ember12" class="controls ember-view"><!----></div>
        <div id="ember13" class="ember-view"><!----></div>
        <div id="ember14" class="ember-view">
            <div class="row">
                <div id="global-notice-alert-read-only" class="alert alert-info alert-read-only">
                    <!----> <span class="text">This site is in read only mode. Please continue to browse, but replying, likes, and other actions are disabled for now.</span>

                    <!---->    </div>
            </div>
            <div class="row">
                <div id="global-notice-alert-global-notice" class="alert alert-info alert-global-notice">
                    <!----> <span class="text"><h3>⚠️ We've moved!</h3>  <p> Hi there!<br><br> To reduce project dependency on 3rd party paid services the StackStorm TSC has decided to move the Q/A from this forum to <a
                        href="https://github.com/StackStorm/st2/discussions">Github Discussions</a>. This will make user experience better integrated with the native Github flow, as well as the questions closer to the community where they can provide answers. </p>  <p> Use 🔗 <b><a
                        href="https://github.com/StackStorm/st2/discussions" class="active">Github Discussions</a></b> to ask your questions. </p></span>

                    <!---->    </div>
            </div>
        </div>
        <div id="ember17" class="hidden create-topics-notice ember-view"><!----></div>
        <!---->
    </div>
    <!-- EOF END -->
    <div id="topic-title">
        <h1>
            <a href="116.html">Do we support multiple replicas for st2sensorcontainer, st2rulesengine in kubernetes-1ppc
                mode?</a>
        </h1>

        <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/core-st2-platform-issues/6" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Platform</span>
              </span>
            </a>
            <meta itemprop="position" content="1"/>
          </span>
        </div>

        <div class="topic-category">
            <div class='discourse-tags list-tags'>
                <a href='../../tag/ha' class='discourse-tag' rel="tag">ha</a>,
                <a href='../../tag/k8s' class='discourse-tag' rel="tag">k8s</a>,
                <a href='../../tag/docker' class='discourse-tag' rel="tag">docker</a>
            </div>
        </div>
    </div>


    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/longfei'><span itemprop='name'>longfei</span></a>
            (longfei.zhang)
          </span>

            <link itemprop="mainEntityOfPage" href="116.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-04-04T02:41:35Z' class='post-time'>
                April 4, 2018,  2:41am
              </time>
              <meta itemprop='dateModified' content='2018-05-15T19:33:30Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Hi Team,<br>
                I deployed st2 using kubernetes-1ppc mode<br>
                I saw all the replicas in the st2.yml are all set to 1<br>
                like st2sensorcontainer<br>
            <aside class="onebox githubblob">
                <header class="source">
                    <a href="https://github.com/StackStorm/st2-docker/blob/master/runtime/kubernetes-1ppc/st2.yml#L128"
                       target="_blank" rel="nofollow noopener">github.com</a>
                </header>
                <article class="onebox-body">
                    <h4>
                        <a href="https://github.com/StackStorm/st2-docker/blob/master/runtime/kubernetes-1ppc/st2.yml#L128"
                           target="_blank" rel="nofollow noopener">StackStorm/st2-docker/blob/master/runtime/kubernetes-1ppc/st2.yml#L128</a>
                    </h4>
                    <pre class="onebox"><code class="lang-yml"><ol class="start lines" start="118"
                                                                   style="counter-reset: li-counter 117 ;">
<li>ports:</li>
<li>- protocol: TCP</li>
<li>  port: 9102</li>
<li>
</li>
<li>---</li>
<li>apiVersion: apps/v1beta1</li>
<li>kind: Deployment</li>
<li>metadata:</li>
<li>name: st2sensorcontainer</li>
<li>spec:</li>
<li class="selected">replicas: 1</li>
<li>template:</li>
<li>  metadata:</li>
<li>    labels:</li>
<li>      app: st2sensorcontainer</li>
<li>  spec:</li>
<li>    containers:</li>
<li>    - name: st2sensorcontainer</li>
<li>      image: stackstorm/stackstorm:latest</li>
<li>      imagePullPolicy: IfNotPresent</li>
<li>      env:</li>
</ol></code></pre>


                </article>
                <div class="onebox-metadata">


                </div>
                <div style="clear: both"></div>
            </aside>
            </p>
            <p>I went through our ha doc and found some st2 comps need to take extra work to achieve HA(like
                st2rulesengine need to disable the timer, st2sensorcontainer need to consider partitioning sensors)<br>
                <a href="https://docs.stackstorm.com/reference/ha.html" class="onebox" target="_blank"
                   rel="nofollow noopener">https://docs.stackstorm.com/reference/ha.html</a><br>
                My question is do we support multi-replicas? expecially for st2sensorcontainer,st2rulesengine, these
                comps.<br>
                Any extra work to do when using kubernetes-1ppc mode?</p>
        </div>

        <meta itemprop='headline'
              content='Do we support multiple replicas for st2sensorcontainer, st2rulesengine in kubernetes-1ppc mode?'>
        <meta itemprop='keywords' content='ha, k8s, docker'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

        <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
            <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                <a href="../ha-failover-with-st2sensorcontainer-and-sensor-partitioning/257.html" itemscope
                   itemtype='http://schema.org/DiscussionForumPosting' itemprop='item'>
                    <meta itemprop='url'
                          content='https://forum.stackstorm.com/t/ha-failover-with-st2sensorcontainer-and-sensor-partitioning/257'>
                    <span itemprop='name'>HA failover with st2sensorcontainer and sensor partitioning</span>
                </a>
                <meta itemprop='position' content='3'>
            </div>
        </div>
    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/warrenvw'><span itemprop='name'>warrenvw</span></a>
            (Warren)
          </span>

            <link itemprop="mainEntityOfPage" href="116.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-04-05T16:47:46Z' class='post-time'>
                April 5, 2018,  4:47pm
              </time>
              <meta itemprop='dateModified' content='2018-04-05T16:47:46Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Sorry… I do not know of any out-of-the-box st2-docker based solution that does the noted extra work
                required to achieve HA. I believe multi-replicas would work in k8s-1ppc mode once these additional
                changes are made.</p>
            <p>Anyone else able to provide a working example?</p>
        </div>

        <meta itemprop='headline'
              content='Do we support multiple replicas for st2sensorcontainer, st2rulesengine in kubernetes-1ppc mode?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/longfei'><span itemprop='name'>longfei</span></a>
            (longfei.zhang)
          </span>

            <link itemprop="mainEntityOfPage" href="116.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-04-18T07:44:17Z' class='post-time'>
                April 18, 2018,  7:44am
              </time>
              <meta itemprop='dateModified' content='2018-04-18T07:44:17Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>I run with following configurations and it worked for me<br>
                replicas:<br>
                st2web: 3<br>
                st2stream: 3<br>
                st2sensorcontainer: 1<br>
                st2rulesengine: 1<br>
                st2resultstracker: 3<br>
                st2notifier: 3<br>
                st2garbagecollector: 1<br>
                st2auth: 3<br>
                st2api: 3<br>
                st2actionrunner: 3<br>
                mistralserver: 3<br>
                mistralapi: 3</p>
        </div>

        <meta itemprop='headline'
              content='Do we support multiple replicas for st2sensorcontainer, st2rulesengine in kubernetes-1ppc mode?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>


    <!-- :preload-content -->
    <footer class="noscript-footer-nav">
        <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
            <a href='../../index.html'>Home</a>
            <a href="../../categories.html">Categories</a>
            <a href="https://forum.stackstorm.com/guidelines">FAQ/Guidelines</a>
            <a href="../../tos.html">Terms of Service</a>
            <a href="../../privacy.html">Privacy Policy</a>
        </nav>
    </footer>
</div>

<footer id='noscript-footer'>
    <p>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>


<section id='main'>
</section>


</body>
</html>
