<!DOCTYPE html>
<html lang="en" class="desktop-view not-mobile-device text-size-normal anon">
<head>
    <meta charset="utf-8">
    <title>Failed to load sensor class - Pack Management - StackStorm Support (ARCHIVED)</title>
    <meta name="description" content="My Flask sensor is active by if I make requests to the endpoint the using REST client the endpoint is found the endpoint, i.e, the Flask application is down. The log /var/log/st2/st2sensorcontainer.log: 
2019-12-22 17:27&amp;hellip;">
    <meta name="discourse_theme_id" content="2">
    <meta name="discourse_current_homepage" content="latest">
    <meta name="generator"
          content="Discourse 2.8.0.beta6 - https://github.com/discourse/discourse version a1daf9fe53a66e2d2cdf9757ab4812fb9a2b2787">
    <link rel="icon" type="image/png"
          href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/379ced12f8326d58f1b3d2b3ff652f883e141f6a_2_32x32.PNG">
    <link rel="apple-touch-icon" type="image/png"
          href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/379ced12f8326d58f1b3d2b3ff652f883e141f6a_2_180x180.PNG">
    <meta name="theme-color" content="#ffffff">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <link rel="canonical" href="971.html"/>
    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "https://forum.stackstorm.com",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://forum.stackstorm.com/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }</script>
    <link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml"
          title="StackStorm Support (ARCHIVED) Search">


    <link href="/../../stylesheets/color_definitions_base__2_3c5eec1ecf192052ea70b4afdab57a62bccc0604.css?__ws=forum.stackstorm.com"
          media="all" rel="stylesheet" class="light-scheme"/>

    <link href="/../../stylesheets/desktop_b2f2968742d41481357e0df259b51ce29f72481a.css?__ws=forum.stackstorm.com"
          media="all" rel="stylesheet" data-target="desktop"/>


    <meta name="fragment" content="!">


    <link id="manifest-link" rel="manifest" href="../../manifest.webmanifest" crossorigin="use-credentials">


    <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Failed to load sensor class&#39;"
          href="https://forum.stackstorm.com/t/failed-to-load-sensor-class/971.rss"/>
    <meta property="og:site_name" content="StackStorm Support (ARCHIVED)"/>
    <meta property="og:type" content="website"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image"
          content="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/891f00fbdb31fecb5bd9dab30c186d2fed0091ca.jpeg"/>
    <meta property="og:image"
          content="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/891f00fbdb31fecb5bd9dab30c186d2fed0091ca.jpeg"/>
    <meta property="og:url" content="https://forum.stackstorm.com/t/failed-to-load-sensor-class/971"/>
    <meta name="twitter:url" content="https://forum.stackstorm.com/t/failed-to-load-sensor-class/971"/>
    <meta property="og:title" content="Failed to load sensor class"/>
    <meta name="twitter:title" content="Failed to load sensor class"/>
    <meta property="og:description"
          content="My Flask sensor is active by if I make requests to the endpoint the using REST client the endpoint is found the endpoint, i.e, the Flask application is down. The log /var/log/st2/st2sensorcontainer.log:  2019-12-22 17:27:18,550 140359279589968 INFO process_container [-] Sensor linux.FileWatchSensor started 2019-12-22 17:27:18,550 140359279589968 INFO process_container [-] Running sensor hub.ClientData 2019-12-22 17:27:18,639 140359279589968 INFO process_container [-] Sensor hub.ClientData starte..."/>
    <meta name="twitter:description"
          content="My Flask sensor is active by if I make requests to the endpoint the using REST client the endpoint is found the endpoint, i.e, the Flask application is down. The log /var/log/st2/st2sensorcontainer.log:  2019-12-22 17:27:18,550 140359279589968 INFO process_container [-] Sensor linux.FileWatchSensor started 2019-12-22 17:27:18,550 140359279589968 INFO process_container [-] Running sensor hub.ClientData 2019-12-22 17:27:18,639 140359279589968 INFO process_container [-] Sensor hub.ClientData starte..."/>
    <meta property="article:published_time" content="2019-12-22T17:50:31+00:00"/>
    <meta property="og:ignore_canonical" content="true"/>


    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "QAPage",
        "name": "Failed to load sensor class",
        "mainEntity": {
            "@type": "Question",
            "name": "Failed to load sensor class",
            "text": "My Flask sensor is active by if I make requests to the endpoint the using REST client the endpoint is found the endpoint, i.e, the Flask application is down. The log /var/log/st2/st2sensorcontainer.log:\n\n2019-12-22 17:27:18,550 140359279589968 INFO process_container [-] Sensor linux.FileWatchSensor &hellip;",
            "upvoteCount": 0,
            "answerCount": 0,
            "dateCreated": "2019-12-22T17:50:31.655Z",
            "author": {
                "@type": "Person",
                "name": "Walter"
            }
        }
    }</script>

    <meta id="data-discourse-setup" data-cdn="https://sjc6.discourse-cdn.com/standard10"
          data-base-url="https://forum.stackstorm.com" data-base-uri="" data-environment="production"
          data-letter-avatar-version="5_8fec8e114563efeaf5265573e510f08e"
          data-markdown-it-url="https://aws1.discourse-cdn.com/standard10/assets/markdown-it-bundle-31e9a9c535ca1801c26da78b0ff465821751a98f921c5cdc5457d7e5a69e9748.js"
          data-service-worker-url="service-worker.js" data-default-locale="en"
          data-asset-version="597e36448c9b51d0fa3b7e43ec1fd6d5" data-disable-custom-css="false"
          data-highlight-js-path="/highlight-js/forum.stackstorm.com/ac0f4aa001e1343346941766d72e0c1ae330832b.js"
          data-svg-sprite-path="/svg-sprite/forum.stackstorm.com/svg-2-c2ad434b1e06079c7e282124aed9938dc95b83ea.js"
          data-enable-js-error-reporting="true" data-color-scheme-is-dark="false" data-user-dark-scheme-id="-1"
          data-s3-cdn="https://aws1.discourse-cdn.com/standard10"
          data-s3-base-url="//discourse-cloud-file-uploads.s3.dualstack.us-west-2.amazonaws.com/standard10">

    <meta name="discourse/config/environment"
          content="%7B%22modulePrefix%22%3A%22discourse%22%2C%22environment%22%3A%22production%22%2C%22rootURL%22%3A%22%22%2C%22locationType%22%3A%22auto%22%2C%22historySupportMiddleware%22%3Afalse%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%2C%22_APPLICATION_TEMPLATE_WRAPPER%22%3Afalse%2C%22_DEFAULT_ASYNC_OBSERVERS%22%3Atrue%2C%22_JQUERY_INTEGRATION%22%3Atrue%7D%2C%22APP%22%3A%7B%22name%22%3A%22discourse%22%2C%22version%22%3A%222.8.0.beta6%20a1daf9fe53a66e2d2cdf9757ab4812fb9a2b2787%22%2C%22exportApplicationGlobal%22%3Atrue%7D%7D"/>
</head>

<body class="">


<header class="d-header">
    <div class="wrap">
        <div class="contents clearfix">
            <div class="title">
                <a href="../../index.html">
                    <picture>
                        <img src="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png"
                             alt="StackStorm Support (ARCHIVED)" id="site-logo"/>
                    </picture>
                </a>
            </div>

        </div>
    </div>
</header>

<div id="main-outlet" class="wrap" role="main">
    <!-- preload-content: -->

    <!-- EOF START -->
    <div class="container" id="main-container">
        <div id="ember11" class="ember-view"></div>
        <div id="ember12" class="controls ember-view"><!----></div>
        <div id="ember13" class="ember-view"><!----></div>
        <div id="ember14" class="ember-view">
            <div class="row">
                <div id="global-notice-alert-read-only" class="alert alert-info alert-read-only">
                    <!----> <span class="text">This site is in read only mode. Please continue to browse, but replying, likes, and other actions are disabled for now.</span>

                    <!---->    </div>
            </div>
            <div class="row">
                <div id="global-notice-alert-global-notice" class="alert alert-info alert-global-notice">
                    <!----> <span class="text"><h3>‚ö†Ô∏è We've moved!</h3>  <p> Hi there!<br><br> To reduce project dependency on 3rd party paid services the StackStorm TSC has decided to move the Q/A from this forum to <a
                        href="https://github.com/StackStorm/st2/discussions">Github Discussions</a>. This will make user experience better integrated with the native Github flow, as well as the questions closer to the community where they can provide answers. </p>  <p> Use üîó <b><a
                        href="https://github.com/StackStorm/st2/discussions" class="active">Github Discussions</a></b> to ask your questions. </p></span>

                    <!---->    </div>
            </div>
        </div>
        <div id="ember17" class="hidden create-topics-notice ember-view"><!----></div>
        <!---->
    </div>
    <!-- EOF END -->
    <div id="topic-title">
        <h1>
            <a href="971.html">Failed to load sensor class</a>
        </h1>

        <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/core-st2-platform-issues/6" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #AB9364'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Platform</span>
              </span>
            </a>
            <meta itemprop="position" content="1"/>
          </span>
            <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/core-st2-platform-issues/pack-management-issues/12" class="badge-wrapper bullet"
               itemprop="item">
              <span class='badge-category-bg' style='background-color: #BF1E2E'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Pack Management</span>
              </span>
            </a>
            <meta itemprop="position" content="2"/>
          </span>
        </div>

    </div>


    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/Sphinxs'><span itemprop='name'>Sphinxs</span></a>
            (Walter)
          </span>

            <link itemprop="mainEntityOfPage" href="971.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-22T17:50:31Z' class='post-time'>
                December 22, 2019,  5:50pm
              </time>
              <meta itemprop='dateModified' content='2019-12-22T17:50:31Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>My Flask sensor is active by if I make requests to the endpoint the using REST client the endpoint is
                found the endpoint, i.e, the Flask application is down. The log
                <em>/var/log/st2/st2sensorcontainer.log</em>:</p>
            <pre><code class="lang-auto">2019-12-22 17:27:18,550 140359279589968 INFO process_container [-] Sensor linux.FileWatchSensor started
2019-12-22 17:27:18,550 140359279589968 INFO process_container [-] Running sensor hub.ClientData
2019-12-22 17:27:18,639 140359279589968 INFO process_container [-] Sensor hub.ClientData started
2019-12-22 17:27:26,107 140316348196976 ERROR (unknown file) [-] Traceback (most recent call last):

2019-12-22 17:27:26,108 140316348196976 ERROR (unknown file) [-]   File "/opt/stackstorm/st2/local/lib/python2.7/site-packages/st2reactor/container/sensor_wrapper.py", line 360, in &lt;module&gt;

2019-12-22 17:27:26,109 140316348196976 ERROR (unknown file) [-]     
2019-12-22 17:27:26,110 140316348196976 ERROR (unknown file) [-] parent_args=parent_args)

2019-12-22 17:27:26,110 140316348196976 ERROR (unknown file) [-]   File "/opt/stackstorm/st2/local/lib/python2.7/site-packages/st2reactor/container/sensor_wrapper.py", line 209, in __init__

2019-12-22 17:27:26,111 140316348196976 ERROR (unknown file) [-]     
2019-12-22 17:27:26,111 140316348196976 ERROR (unknown file) [-] self._sensor_instance = self._get_sensor_instance()

2019-12-22 17:27:26,112 140316348196976 ERROR (unknown file) [-]   File "/opt/stackstorm/st2/local/lib/python2.7/site-packages/st2reactor/container/sensor_wrapper.py", line 295, in _get_sensor_instance

2019-12-22 17:27:26,112 140316348196976 ERROR (unknown file) [-]     
2019-12-22 17:27:26,113 140316348196976 ERROR (unknown file) [-] raise exc_cls(msg)

2019-12-22 17:27:26,113 140316348196976 ERROR (unknown file) [-] Exception
2019-12-22 17:27:26,114 140316348196976 ERROR (unknown file) [-] : 
2019-12-22 17:27:26,114 140316348196976 ERROR (unknown file) [-] Failed to load sensor class from file "/opt/stackstorm/packs/hub/sensors/client_data.py" (sensor file most likely doesn't exist or contains invalid syntax): Directory "/opt/stackstorm/packs/hub/sensors" with plugins doesn't exist

Traceback (most recent call last):
  File "/opt/stackstorm/st2/local/lib/python2.7/site-packages/st2reactor/container/sensor_wrapper.py", line 288, in _get_sensor_instance
    class_name=self._class_name)
  File "/opt/stackstorm/st2/lib/python2.7/site-packages/st2common/util/loader.py", line 141, in register_plugin_class
    _register_plugin_path(plugin_dir)
  File "/opt/stackstorm/st2/lib/python2.7/site-packages/st2common/util/loader.py", line 52, in _register_plugin_path
    raise Exception('Directory "%s" with plugins doesn\'t exist' % (plugin_dir_abs_path))
Exception: Directory "/opt/stackstorm/packs/hub/sensors" with plugins doesn't exist

2019-12-22 17:27:26,114 140316348196976 ERROR (unknown file) [-] 

2019-12-22 17:27:26,344 140234734586608 INFO sensor_wrapper [-] No config found for sensor "FileWatchSensor"
2019-12-22 17:27:26,345 140234734586608 INFO sensor_wrapper [-] Watcher started
2019-12-22 17:27:26,346 140234734586608 INFO sensor_wrapper [-] Running sensor initialization code
2019-12-22 17:27:26,361 140234734586608 INFO sensor_wrapper [-] Running sensor in passive mode
</code></pre>
            <p>How can I fix it, I have already read the code and have not found anything wrong, besides this, if I run
                <code>/opt/stackstorm/st2/bin/st2sensorcontainer</code> the Flask is up and I can make requests to the
                end point‚Ä¶</p>
        </div>

        <meta itemprop='headline' content='Failed to load sensor class'>
        <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/blag'><span itemprop='name'>blag</span></a>
            
          </span>

            <link itemprop="mainEntityOfPage" href="971.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-23T02:31:10Z' class='post-time'>
                December 23, 2019,  2:31am
              </time>
              <meta itemprop='dateModified' content='2019-12-23T02:31:10Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Please post your sensor code, and redact any sensitive information from it. It‚Äôs pretty much impossible
                to answer your question without having any idea what your code is doing.</p>
            <p>This line seems to indicate the exact error:</p>
            <pre><code class="lang-auto">Exception: Directory "/opt/stackstorm/packs/hub/sensors" with plugins doesn't exist
</code></pre>
            <p>Can you verify that the directory <code>/opt/stackstorm/packs/hub/sensors</code> exists?</p>
            <p>If it doesn‚Äôt exist, where is your sensor being loaded from (eg: which pack)?</p>
            <p>If it does exist, have you checked your sensor into git? StackStorm requires packs to be git
                repositories.</p>
            <p>I would make changes to your pack in one directory (eg: <code>/home/vagrant/hub</code>), and then run
                <code>st2 pack install file://$(pwd)</code> to install the pack, and reload pack data with <code>st2ctl
                    reload</code>.</p>
            <p>Please remember that the only context that we are aware of is what you post here. Posting only the
                traceback doesn‚Äôt tell us how you are running StackStorm, how you are developing your pack, what your
                pack is trying to do, how your sensor is structured/coded, what your sensor is trying to do, etc. The
                more information you give us, the better we are able to help you.</p>
        </div>

        <meta itemprop='headline' content='Failed to load sensor class'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/Sphinxs'><span itemprop='name'>Sphinxs</span></a>
            (Walter)
          </span>

            <link itemprop="mainEntityOfPage" href="971.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2019-12-26T18:26:29Z' class='post-time'>
                December 26, 2019,  6:26pm
              </time>
              <meta itemprop='dateModified' content='2019-12-26T18:42:26Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <ol>
                <li>The sensor it‚Äôs exactly like <a
                        href="https://github.com/StackStorm/st2/blob/master/contrib/examples/sensors/echo_flask_app.py"
                        rel="nofollow noopener">this</a> one, the change I made was to add a Elasticsearch connection in
                    the <code>__init__</code> method:
                </li>
            </ol>
            <pre><code class="lang-python">def __init__(self, config):
    self._els = elasticsearch.Elasticsearch([
        {
            'host': config['host'],
            'port': config['port'],
            'use_ssl': config['use_ssl'],
            'http_auth': (config['user'], config['pass'])
        }
    ])
</code></pre>
            <ol start="2">
                <li>Yes, it exists, I have checked all these folders / a few subfolders:</li>
            </ol>
            <p><em>/opt/stackstorm/packs</em></p>
            <p><em>/opt/stackstorm/virtualenvs</em></p>
            <p><em>/st2-docker/st2.d</em></p>
            <p><em>/opt/stackstorm/configs</em></p>
            <ol start="3">
                <li>
                    <p>I have placed the pack inside the <code>/opt/stackstorm/packs</code> and granted the permisions
                        <code>chgrp -R st2packs /opt/stackstorm/packs/hub</code> (before create the virtual
                        environments)</p>
                </li>
                <li>
                    <p>I‚Äôm using Docker and not Vegrant</p>
                </li>
                <li>
                    <p>I have tried to install instead of copy and then grant the permissions / install the virtual
                        environments</p>
                </li>
                <li>
                    <p>Again: if I start the sensor container manually everything works fine, the problem its that this
                        container its not starting automatically (I have created an issue in the Stack Storm Docker
                        repository and by now I‚Äôm starting it manually after create the virtual environments in the <em>/st2.d/virtualenv.sh</em>)
                    </p>
                </li>
            </ol>
            <p>Thanks for the feedback <img src="https://emoji.discourse-cdn.com/apple/slight_smile.png?v=9"
                                            title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
            <p><em>Observation</em>: I have used <a href="https://pypi.org/project/prospector2/"
                                                    rel="nofollow noopener">prospector</a> to check the Python sensor
                file and everything is okay</p>
        </div>

        <meta itemprop='headline' content='Failed to load sensor class'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>


    <!-- :preload-content -->
    <footer class="noscript-footer-nav">
        <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
            <a href='../../index.html'>Home</a>
            <a href="../../categories.html">Categories</a>
            <a href="https://forum.stackstorm.com/guidelines">FAQ/Guidelines</a>
            <a href="../../tos.html">Terms of Service</a>
            <a href="../../privacy.html">Privacy Policy</a>
        </nav>
    </footer>
</div>

<footer id='noscript-footer'>
    <p>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>


<section id='main'>
</section>


</body>
</html>
