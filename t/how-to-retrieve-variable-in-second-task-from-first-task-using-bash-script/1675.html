<!DOCTYPE html>
<html lang="en" class="desktop-view not-mobile-device text-size-normal anon">
<head>
    <meta charset="utf-8">
    <title>How to retrieve variable in second task from first task using bash script? - Mistral - StackStorm Support
        (ARCHIVED)</title>
    <meta name="description" content="Hi there, I am new to stackstorm. I need help to resolve the problem, I am having. 
I am working on one workflow that will get variable information from first task and use that variable in second task using bash script. &amp;hellip;">
    <meta name="discourse_theme_id" content="2">
    <meta name="discourse_current_homepage" content="latest">
    <meta name="generator"
          content="Discourse 2.8.0.beta6 - https://github.com/discourse/discourse version a1daf9fe53a66e2d2cdf9757ab4812fb9a2b2787">
    <link rel="icon" type="image/png"
          href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/379ced12f8326d58f1b3d2b3ff652f883e141f6a_2_32x32.PNG">
    <link rel="apple-touch-icon" type="image/png"
          href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/379ced12f8326d58f1b3d2b3ff652f883e141f6a_2_180x180.PNG">
    <meta name="theme-color" content="#ffffff">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <link rel="canonical" href="1675.html"/>
    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "https://forum.stackstorm.com",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://forum.stackstorm.com/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    <link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml"
          title="StackStorm Support (ARCHIVED) Search">


    <link href="/../../stylesheets/color_definitions_base__2_3c5eec1ecf192052ea70b4afdab57a62bccc0604.css?__ws=forum.stackstorm.com"
          media="all" rel="stylesheet" class="light-scheme"/>

    <link href="/../../stylesheets/desktop_b2f2968742d41481357e0df259b51ce29f72481a.css?__ws=forum.stackstorm.com"
          media="all" rel="stylesheet" data-target="desktop"/>


    <meta name="fragment" content="!">


    <link id="manifest-link" rel="manifest" href="../../manifest.webmanifest" crossorigin="use-credentials">


    <link rel="alternate" type="application/rss+xml"
          title="RSS feed of &#39;How to retrieve variable in second task from first task using bash script?&#39;"
          href="1675.rss"/>
    <meta property="og:site_name" content="StackStorm Support (ARCHIVED)"/>
    <meta property="og:type" content="website"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image"
          content="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/891f00fbdb31fecb5bd9dab30c186d2fed0091ca.jpeg"/>
    <meta property="og:image"
          content="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/891f00fbdb31fecb5bd9dab30c186d2fed0091ca.jpeg"/>
    <meta property="og:url"
          content="https://forum.stackstorm.com/t/how-to-retrieve-variable-in-second-task-from-first-task-using-bash-script/1675"/>
    <meta name="twitter:url"
          content="https://forum.stackstorm.com/t/how-to-retrieve-variable-in-second-task-from-first-task-using-bash-script/1675"/>
    <meta property="og:title" content="How to retrieve variable in second task from first task using bash script?"/>
    <meta name="twitter:title" content="How to retrieve variable in second task from first task using bash script?"/>
    <meta property="og:description"
          content="Hi there, I am new to stackstorm. I need help to resolve the problem, I am having.  I am working on one workflow that will get variable information from first task and use that variable in second task using bash script. I see that is possible using python, but I would prefer to do with bash. Here is the workflow.  input:   - value1   - value2   - value3  output:   - value2: &lt;% ctx().value2 %&gt;   - value3: &lt;% ctx().value3 %&gt;  tasks:   task1:     action: jobname.get_info value1=&lt;% ctx(value1) %&gt;   ..."/>
    <meta name="twitter:description"
          content="Hi there, I am new to stackstorm. I need help to resolve the problem, I am having.  I am working on one workflow that will get variable information from first task and use that variable in second task using bash script. I see that is possible using python, but I would prefer to do with bash. Here is the workflow.  input:   - value1   - value2   - value3  output:   - value2: &lt;% ctx().value2 %&gt;   - value3: &lt;% ctx().value3 %&gt;  tasks:   task1:     action: jobname.get_info value1=&lt;% ctx(value1) %&gt;   ..."/>
    <meta property="article:published_time" content="2021-05-03T14:55:52+00:00"/>
    <meta property="og:ignore_canonical" content="true"/>


    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "QAPage",
        "name": "How to retrieve variable in second task from first task using bash script?",
        "mainEntity": {
            "@type": "Question",
            "name": "How to retrieve variable in second task from first task using bash script?",
            "text": "Hi there, I am new to stackstorm. I need help to resolve the problem, I am having.\n\nI am working on one workflow that will get variable information from first task and use that variable in second task using bash script. I see that is possible using python, but I would prefer to do with bash. Here is&hellip;",
            "upvoteCount": 0,
            "answerCount": 0,
            "dateCreated": "2021-05-03T14:55:52.505Z",
            "author": {
                "@type": "Person",
                "name": "patrik"
            }
        }
    }
    </script>

    <meta id="data-discourse-setup" data-cdn="https://sjc6.discourse-cdn.com/standard10"
          data-base-url="https://forum.stackstorm.com" data-base-uri="" data-environment="production"
          data-letter-avatar-version="5_8fec8e114563efeaf5265573e510f08e"
          data-markdown-it-url="https://aws1.discourse-cdn.com/standard10/assets/markdown-it-bundle-31e9a9c535ca1801c26da78b0ff465821751a98f921c5cdc5457d7e5a69e9748.js"
          data-service-worker-url="service-worker.js" data-default-locale="en"
          data-asset-version="597e36448c9b51d0fa3b7e43ec1fd6d5" data-disable-custom-css="false"
          data-highlight-js-path="/highlight-js/forum.stackstorm.com/ac0f4aa001e1343346941766d72e0c1ae330832b.js"
          data-svg-sprite-path="/svg-sprite/forum.stackstorm.com/svg-2-c2ad434b1e06079c7e282124aed9938dc95b83ea.js"
          data-enable-js-error-reporting="true" data-color-scheme-is-dark="false" data-user-dark-scheme-id="-1"
          data-s3-cdn="https://aws1.discourse-cdn.com/standard10"
          data-s3-base-url="//discourse-cloud-file-uploads.s3.dualstack.us-west-2.amazonaws.com/standard10">

    <meta name="discourse/config/environment"
          content="%7B%22modulePrefix%22%3A%22discourse%22%2C%22environment%22%3A%22production%22%2C%22rootURL%22%3A%22%22%2C%22locationType%22%3A%22auto%22%2C%22historySupportMiddleware%22%3Afalse%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%2C%22_APPLICATION_TEMPLATE_WRAPPER%22%3Afalse%2C%22_DEFAULT_ASYNC_OBSERVERS%22%3Atrue%2C%22_JQUERY_INTEGRATION%22%3Atrue%7D%2C%22APP%22%3A%7B%22name%22%3A%22discourse%22%2C%22version%22%3A%222.8.0.beta6%20a1daf9fe53a66e2d2cdf9757ab4812fb9a2b2787%22%2C%22exportApplicationGlobal%22%3Atrue%7D%7D"/>
</head>

<body class="">


<header class="d-header">
    <div class="wrap">
        <div class="contents clearfix">
            <div class="title">
                <a href="../../index.html">
                    <picture>
                        <img src="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png"
                             alt="StackStorm Support (ARCHIVED)" id="site-logo"/>
                    </picture>
                </a>
            </div>

        </div>
    </div>
</header>

<div id="main-outlet" class="wrap" role="main">
    <!-- preload-content: -->

    <!-- EOF START -->
    <div class="container" id="main-container">
        <div id="ember11" class="ember-view"></div>
        <div id="ember12" class="controls ember-view"><!----></div>
        <div id="ember13" class="ember-view"><!----></div>
        <div id="ember14" class="ember-view">
            <div class="row">
                <div id="global-notice-alert-read-only" class="alert alert-info alert-read-only">
                    <!----> <span class="text">This site is in read only mode. Please continue to browse, but replying, likes, and other actions are disabled for now.</span>

                    <!---->    </div>
            </div>
            <div class="row">
                <div id="global-notice-alert-global-notice" class="alert alert-info alert-global-notice">
                    <!----> <span class="text"><h3>‚ö†Ô∏è We've moved!</h3>  <p> Hi there!<br><br> To reduce project dependency on 3rd party paid services the StackStorm TSC has decided to move the Q/A from this forum to <a
                        href="https://github.com/StackStorm/st2/discussions">Github Discussions</a>. This will make user experience better integrated with the native Github flow, as well as the questions closer to the community where they can provide answers. </p>  <p> Use üîó <b><a
                        href="https://github.com/StackStorm/st2/discussions" class="active">Github Discussions</a></b> to ask your questions. </p></span>

                    <!---->    </div>
            </div>
        </div>
        <div id="ember17" class="hidden create-topics-notice ember-view"><!----></div>
        <!---->
    </div>
    <!-- EOF END -->
    <div id="topic-title">
        <h1>
            <a href="1675.html">How to retrieve variable in second task from first task using bash script?</a>
        </h1>

        <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/workflow-related-issues/15" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Workflows</span>
              </span>
            </a>
            <meta itemprop="position" content="1"/>
          </span>
            <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/workflow-related-issues/mistral-related-issues/16" class="badge-wrapper bullet"
               itemprop="item">
              <span class='badge-category-bg' style='background-color: #652D90'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Mistral</span>
              </span>
            </a>
            <meta itemprop="position" content="2"/>
          </span>
        </div>

    </div>


    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/patrik'><span itemprop='name'>patrik</span></a>
            (patrik)
          </span>

            <link itemprop="mainEntityOfPage" href="1675.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-05-03T14:55:52Z' class='post-time'>
                May 3, 2021,  2:55pm
              </time>
              <meta itemprop='dateModified' content='2021-05-03T15:15:28Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Hi there, I am new to stackstorm. I need help to resolve the problem, I am having.</p>
            <p>I am working on one workflow that will get variable information from first task and use that variable in
                second task using bash script. I see that is possible using python, but I would prefer to do with bash.
                Here is the workflow.</p>
            <pre><code class="lang-auto">input:
  - value1
  - value2
  - value3

output:
  - value2: &lt;% ctx().value2 %&gt;
  - value3: &lt;% ctx().value3 %&gt;

tasks:
  task1:
    action: jobname.get_info value1=&lt;% ctx(value1) %&gt;
    next:
      - when: &lt;% succeeded() %&gt;
        publish:
          - stdout: &lt;% result().stdout %&gt;
          - stderr: &lt;% result().stderr %&gt;
          - value2: &lt;% ctx("value2") %&gt;, &lt;% result().result %&gt;
          - value3: &lt;% ctx("value3") %&gt;, &lt;% result().result %&gt;
      - do: task2
      - when: &lt;% failed() %&gt;
        publish: stderr=&lt;% result().stderr %&gt;
        do: fail

  task2:
    action: job.name2 value2=&lt;% ctx(value2) %&gt;
    next:
      - when: &lt;% succeeded() %&gt;
        publish:
          - stdout: &lt;% result().stdout %&gt;
          - stderr: &lt;% result().stderr %&gt;
      - do: task3
      - when: &lt;% failed() %&gt;
        publish: stderr=&lt;% result().stderr %&gt;
        do: fail
</code></pre>
            <p>I see that the first job gets succeeded without any error, but the second job uses <code>value2</code> in
                the execution, so it won‚Äôt move forward in execution and errors out.</p>
            <pre><code class="lang-auto">{
  "output": null,
  "errors": [
    {
      "message": "YaqlEvaluationException: Unable to resolve key 'result' in expression '&lt;% result().result %&gt;' from context.",
      "task_transition_id": "noop__t0",
      "type": "error",
      "route": 0,
      "task_id": "task1"
    },
    {
      "message": "YaqlEvaluationException: Unable to evaluate expression '&lt;% ctx(stdout) %&gt;'. VariableUndefinedError: The variable \"stdout\" is undefined.",
      "type": "error"
    }
  ]
}
</code></pre>
            <p>Thanks in advance!! <img src="https://emoji.discourse-cdn.com/apple/slight_smile.png?v=9"
                                        title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
        </div>

        <meta itemprop='headline' content='How to retrieve variable in second task from first task using bash script?'>
        <meta itemprop='keywords' content=''>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/blag'><span itemprop='name'>blag</span></a>
            
          </span>

            <link itemprop="mainEntityOfPage" href="1675.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-05-07T17:46:54Z' class='post-time'>
                May 7, 2021,  5:46pm
              </time>
              <meta itemprop='dateModified' content='2021-05-07T17:46:54Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>You have a bug in your YAML. The <code>task1.next</code> block looks like this (represented in JSON) to
                make it more apparent:</p>
            <pre><code class="lang-auto">[
  {
    "when": ...,
    "publish": ...
  },
  {
    "do": ...
  },
  {
    "when": ...,
    "publish": ...,
    "do": ...
  }
]
</code></pre>
            <p>The dictionary for the <code>do</code> item does not have a <code>when</code> key, and the
                <code>when</code> item does not have a <code>do</code> key.</p>
            <p>That is actually valid Orquesta, but it‚Äôs likely not what you want.</p>
            <p>What that does is publish some values to the workflow context (when <code>task1</code> is successful). If
                <code>task1</code> fails, it transitions to the builtin <code>fail</code> task. And because the
                <code>do</code> block doesn‚Äôt have a <code>when</code> key, Orquesta will <strong>always</strong> try to
                transition to <code>task2</code> regardless of whether <code>task1</code> succeeds or fails - that‚Äôs not
                what you want.</p>
            <p>I think you want the workflow to publish <code>stdout</code>, <code>stderr</code>, <code>value2</code>,
                and <code>value3</code> to the workflow context and to transition to <code>task2</code> <em>only</em>
                when <code>task1</code> succeeds.</p>
            <p>So to do that, you want to do the following (represented in JSON):</p>
            <pre><code class="lang-auto">[
  {
    "when": ...,
    "publish": ...,
    "do": ...
  },
  {
    "when": ...,
    "publish": ...,
    "do": ...
  }
]
</code></pre>
            <p>Or to represent that in YAML:</p>
            <pre><code class="lang-auto">      - when: &lt;% succeeded() %&gt;
        publish:
          - stdout: &lt;% result().stdout %&gt;
          - stderr: &lt;% result().stderr %&gt;
          - value2: &lt;% ctx("value2") %&gt;, &lt;% result().result %&gt;
          - value3: &lt;% ctx("value3") %&gt;, &lt;% result().result %&gt;
        do: task2
      # ^ no longer a list item on its own, it's now in the
      #   same list item as the `when` and `publish` keys
      - when: &lt;% failed() %&gt;
        publish: stderr=&lt;% result().stderr %&gt;
        do: fail
</code></pre>
        </div>

        <meta itemprop='headline' content='How to retrieve variable in second task from first task using bash script?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/patrik'><span itemprop='name'>patrik</span></a>
            (patrik)
          </span>

            <link itemprop="mainEntityOfPage" href="1675.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-05-11T13:46:52Z' class='post-time'>
                May 11, 2021,  1:46pm
              </time>
              <meta itemprop='dateModified' content='2021-05-11T13:46:52Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p><a class="mention" href="https://github.com/blag">@blag</a> Thanks for putting time and
                effort to help me on the issue/problem I am having.</p>
            <p>But here, I am looking solution of how do I publish <code>value2</code> and <code>value3</code> in <code>task1</code>
                and use those values further on in workflow in other tasks where mentioned.</p>
            <p>You can see I have used <code>value2</code> in <code>task2</code> and I am also going to use
                <code>value2</code> and <code>value3</code> in task 3 to accomplish the whole task.</p>
            <p>Again thanks!!</p>
        </div>

        <meta itemprop='headline' content='How to retrieve variable in second task from first task using bash script?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/blag'><span itemprop='name'>blag</span></a>
            
          </span>

            <link itemprop="mainEntityOfPage" href="1675.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-05-11T16:12:23Z' class='post-time'>
                May 11, 2021,  4:12pm
              </time>
              <meta itemprop='dateModified' content='2021-05-11T16:12:23Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Yep, I think I understand what you are trying to do, and my answer doesn‚Äôt change - you have an error in
                your workflow. It‚Äôs valid YAML but they way that it‚Äôs interpreted by Orquesta isn‚Äôt correct. If you
                change your workflow the way I suggested, then you should be able to access <code>value2</code> and
                <code>value3</code> in further tasks like <code>task2</code> and <code>task3</code>.</p>
        </div>

        <meta itemprop='headline' content='How to retrieve variable in second task from first task using bash script?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/patrik'><span itemprop='name'>patrik</span></a>
            (patrik)
          </span>

            <link itemprop="mainEntityOfPage" href="1675.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-05-11T17:45:47Z' class='post-time'>
                May 11, 2021,  5:45pm
              </time>
              <meta itemprop='dateModified' content='2021-05-11T17:55:31Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p><a class="mention" href="https://github.com/blag">@blag</a> Thanks for your prompt reply on
                my comment. I have updated workflow and tried to execute by making changes in YAML as you suggested. The
                first task goes successful and then even it doesn‚Äôt initiate the second task and I get below error.</p>
            <pre><code class="lang-auto">{
  "output": null,
  "errors": [
    {
      "message": "YaqlEvaluationException: Unable to resolve key 'result' in expression '&lt;% result().result %&gt;' from context.",
      "task_transition_id": "task2__t0",
      "type": "error",
      "route": 0,
      "task_id": "task1"
    },
    {
      "message": "YaqlEvaluationException: Unable to evaluate expression '&lt;% ctx(stdout) %&gt;'. VariableUndefinedError: The variable \"stdout\" is undefined.",
      "type": "error"
    }
  ]
}
</code></pre>
            <p>FYI, here is the workflow:</p>
            <pre><code class="lang-auto">input:
  - value1
  - value2
  - value3

output:
  - value2: &lt;% ctx().value2 %&gt;
  - value3: &lt;% ctx().value3 %&gt;

tasks:
  task1:
    action: jobname.get_info value1 =&lt;% ctx(value1) %&gt;
    next:
      - when: &lt;% succeeded() %&gt;
        publish:
          - stdout: &lt;% result().stdout %&gt;
          - stderr: &lt;% result().stderr %&gt;
          - value2: &lt;% ctx("value2") %&gt;, &lt;% result().result %&gt;
          - value3: &lt;% ctx("value3") %&gt;, &lt;% result().result %&gt;
        do: task2
      - when: &lt;% failed() %&gt;
        publish: stderr=&lt;% result().stderr %&gt;
        do: fail

  task2:
    action: jobname2 value2=&lt;% ctx(value2) %&gt;
    next:
      - when: &lt;% succeeded() %&gt;
        publish:
          - stdout: &lt;% result().stdout %&gt;
          - stderr: &lt;% result().stderr %&gt;
        do: task3
      - when: &lt;% failed() %&gt;
        publish: stderr=&lt;% result().stderr %&gt;
        do: fail
</code></pre>
        </div>

        <meta itemprop='headline' content='How to retrieve variable in second task from first task using bash script?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/blag'><span itemprop='name'>blag</span></a>
            
          </span>

            <link itemprop="mainEntityOfPage" href="1675.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-05-11T18:17:52Z' class='post-time'>
                May 11, 2021,  6:17pm
              </time>
              <meta itemprop='dateModified' content='2021-05-11T18:17:52Z'>
          <span itemprop='position'>#6</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Hmmm, neither of those two errors make sense with the workflow you just posted. How are you updating your
                workflow on the ST2 server? Are you running <code>st2 pack install ...</code> and <code>st2ctl
                    reload</code> every time you update the workflow? Or are you directly editing the workflow YAML file
                on the YAML server?</p>
        </div>

        <meta itemprop='headline' content='How to retrieve variable in second task from first task using bash script?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/patrik'><span itemprop='name'>patrik</span></a>
            (patrik)
          </span>

            <link itemprop="mainEntityOfPage" href="1675.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-05-11T19:33:41Z' class='post-time'>
                May 11, 2021,  7:33pm
              </time>
              <meta itemprop='dateModified' content='2021-05-11T19:33:41Z'>
          <span itemprop='position'>#7</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>I run a job that kicks off <code>st2 pack install</code> on the server, once I update the workflow YAML
                file.</p>
        </div>

        <meta itemprop='headline' content='How to retrieve variable in second task from first task using bash script?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/blag'><span itemprop='name'>blag</span></a>
            
          </span>

            <link itemprop="mainEntityOfPage" href="1675.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-05-13T20:54:34Z' class='post-time'>
                May 13, 2021,  8:54pm
              </time>
              <meta itemprop='dateModified' content='2021-05-13T20:54:34Z'>
          <span itemprop='position'>#8</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Hmmm, something appears to be amiss. If you‚Äôre on ST2 3.4+, I would load up your workflow in the workflow
                editor and make sure that the publish section of the task transitions shows what you expect, and double
                check that the ‚Äúcached‚Äù workflow file in <code>/opt/stackstorm/packs/&lt;pack_name&gt;/actions/workflows/&lt;workflow_file_name&gt;.yaml</code>
                is what you expect.</p>
            <p>I‚Äôm hoping that it‚Äôs not what you expect, because that would pinpoint the problem.</p>
            <p>But if it is what you expect, then there‚Äôs something else going on that I‚Äôm not understanding.</p>
        </div>

        <meta itemprop='headline' content='How to retrieve variable in second task from first task using bash script?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/patrik'><span itemprop='name'>patrik</span></a>
            (patrik)
          </span>

            <link itemprop="mainEntityOfPage" href="1675.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-06-14T14:51:05Z' class='post-time'>
                June 14, 2021,  2:51pm
              </time>
              <meta itemprop='dateModified' content='2021-06-14T14:51:05Z'>
          <span itemprop='position'>#9</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p><a class="mention" href="https://github.com/blag">@blag</a> I really appreciate for taking
                time and replying to the issue I am having. I have verified, double checked the workflow file. Found
                that that is the change I am applying.</p>
            <p>I also saw that when I execute the job, it takes the whole output considers <code>value2</code> and
                executes the second job and fails since it doesn‚Äôt find <code>value3</code>.</p>
            <p>I honestly not sure, what else to try on this issue.</p>
            <p>Thanks again!!</p>
        </div>

        <meta itemprop='headline' content='How to retrieve variable in second task from first task using bash script?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/jamesdreid'><span
                    itemprop='name'>jamesdreid</span></a>
            (James Reid)
          </span>

            <link itemprop="mainEntityOfPage" href="1675.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2021-06-21T19:17:09Z' class='post-time'>
                June 21, 2021,  7:17pm
              </time>
              <meta itemprop='dateModified' content='2021-06-21T19:17:09Z'>
          <span itemprop='position'>#10</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Difficult to determine the exact fix without seeing the syntax of the action being called and how it
                outputs the results, but the error message posted above indicates that you are attempting assign a
                variable in Task1 to a key that cannot be resolved to in the output.</p>
            <pre><code class="lang-auto">    {
      "message": "YaqlEvaluationException: Unable to resolve key 'result' in expression '&lt;% result().result %&gt;' from context.",
      "task_transition_id": "task2__t0",
      "type": "error",
      "route": 0,
      "task_id": "task1"
    },
</code></pre>
            <p>In order for the publish to work and the variables to be published as listed in task1, the output of the
                ‚Äújobname.get_info‚Äù action would have to appear as follows (sample from the Orion Node Create
                action):</p>
            <pre><code class="lang-auto">{
  "stdout": "",
  "stderr": "",
  "exit_code": 0,
  "result": {
    "label": "LABEL_DATA",
    "node_id": "9999999"
  }
}
</code></pre>
        </div>

        <meta itemprop='headline' content='How to retrieve variable in second task from first task using bash script?'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>


    <!-- :preload-content -->
    <footer class="noscript-footer-nav">
        <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
            <a href='../../index.html'>Home</a>
            <a href="../../categories.html">Categories</a>
            <a href="https://forum.stackstorm.com/guidelines">FAQ/Guidelines</a>
            <a href="../../tos.html">Terms of Service</a>
            <a href="../../privacy.html">Privacy Policy</a>
        </nav>
    </footer>
</div>

<footer id='noscript-footer'>
    <p>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>


<section id='main'>
</section>


</body>
</html>
