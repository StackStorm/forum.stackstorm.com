<!DOCTYPE html>
<html lang="en" class="desktop-view not-mobile-device text-size-normal anon">
<head>
    <meta charset="utf-8">
    <title>Multiple actions in one loop based on the current item - Workflows - StackStorm Support (ARCHIVED)</title>
    <meta name="description" content="Hi, 
what I am trying to do is a workflow that at some point needs to loop over a list of dictionary items. In this loop I need to start several actions using values from the current item as input. As the last step of on&amp;hellip;">
    <meta name="discourse_theme_id" content="2">
    <meta name="discourse_current_homepage" content="latest">
    <meta name="generator"
          content="Discourse 2.8.0.beta6 - https://github.com/discourse/discourse version a1daf9fe53a66e2d2cdf9757ab4812fb9a2b2787">
    <link rel="icon" type="image/png"
          href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/379ced12f8326d58f1b3d2b3ff652f883e141f6a_2_32x32.PNG">
    <link rel="apple-touch-icon" type="image/png"
          href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/379ced12f8326d58f1b3d2b3ff652f883e141f6a_2_180x180.PNG">
    <meta name="theme-color" content="#ffffff">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <link rel="canonical" href="1452.html"/>
    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "https://forum.stackstorm.com",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://forum.stackstorm.com/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    <link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml"
          title="StackStorm Support (ARCHIVED) Search">


    <link href="/../../stylesheets/color_definitions_base__2_3c5eec1ecf192052ea70b4afdab57a62bccc0604.css?__ws=forum.stackstorm.com"
          media="all" rel="stylesheet" class="light-scheme"/>

    <link href="/../../stylesheets/desktop_b2f2968742d41481357e0df259b51ce29f72481a.css?__ws=forum.stackstorm.com"
          media="all" rel="stylesheet" data-target="desktop"/>


    <meta name="fragment" content="!">


    <link id="manifest-link" rel="manifest" href="../../manifest.webmanifest" crossorigin="use-credentials">


    <link rel="alternate" type="application/rss+xml"
          title="RSS feed of &#39;Multiple actions in one loop based on the current item&#39;" href="1452.rss"/>
    <meta property="og:site_name" content="StackStorm Support (ARCHIVED)"/>
    <meta property="og:type" content="website"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image"
          content="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/bdf7f5f99a3926e7475d9fc40728685cc2096b76_2_630x1024.png"/>
    <meta property="og:image"
          content="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/bdf7f5f99a3926e7475d9fc40728685cc2096b76_2_630x1024.png"/>
    <meta property="og:url"
          content="https://forum.stackstorm.com/t/multiple-actions-in-one-loop-based-on-the-current-item/1452"/>
    <meta name="twitter:url"
          content="https://forum.stackstorm.com/t/multiple-actions-in-one-loop-based-on-the-current-item/1452"/>
    <meta property="og:title" content="Multiple actions in one loop based on the current item"/>
    <meta name="twitter:title" content="Multiple actions in one loop based on the current item"/>
    <meta property="og:description"
          content="Hi,  what I am trying to do is a workflow that at some point needs to loop over a list of dictionary items. In this loop I need to start several actions using values from the current item as input. As the last step of one iteration of the loop I want to use all results in an final action.  I created a picture for better understanding:     So far I was not able to identify a solution. I tried multiple actions in a with statement but it looks like only the last action definition is used.  Also pub..."/>
    <meta name="twitter:description"
          content="Hi,  what I am trying to do is a workflow that at some point needs to loop over a list of dictionary items. In this loop I need to start several actions using values from the current item as input. As the last step of one iteration of the loop I want to use all results in an final action.  I created a picture for better understanding:     So far I was not able to identify a solution. I tried multiple actions in a with statement but it looks like only the last action definition is used.  Also pub..."/>
    <meta property="article:published_time" content="2020-10-14T10:55:10+00:00"/>
    <meta property="og:ignore_canonical" content="true"/>


    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "QAPage",
        "name": "Multiple actions in one loop based on the current item",
        "mainEntity": {
            "@type": "Question",
            "name": "Multiple actions in one loop based on the current item",
            "text": "Hi,\n\nwhat I am trying to do is a workflow that at some point needs to loop over a list of dictionary items. In this loop I need to start several actions using values from the current item as input. As the last step of one iteration of the loop I want to use all results in an final action.\n\nI created&hellip;",
            "upvoteCount": 0,
            "answerCount": 1,
            "dateCreated": "2020-10-14T10:55:10.771Z",
            "author": {
                "@type": "Person",
                "name": "Nikolas"
            },
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "<a class=\"mention\" href="
                https://forum.stackstorm.com/t/multiple-actions-in-one-loop-based-on-the-current-item/\&quot;/u/wingi\&quot;">@wingi<\/a> You can make another workflow with those “several actions” in it, then your main workflow can use with-items to invoke that workflow once per item in your dictionary.\n\nDoes this make sense?","upvoteCount":0,"dateCreated":"2020-10-14T15:56:28.910Z","url":"https://forum.stackstorm.com/t/multiple-actions-in-one-loop-based-on-the-current-item/1452/2","author":{"@type":"Person","name":"nmaludy"}}}}
    </script>

    <meta id="data-discourse-setup" data-cdn="https://sjc6.discourse-cdn.com/standard10"
          data-base-url="https://forum.stackstorm.com" data-base-uri="" data-environment="production"
          data-letter-avatar-version="5_8fec8e114563efeaf5265573e510f08e"
          data-markdown-it-url="https://aws1.discourse-cdn.com/standard10/assets/markdown-it-bundle-31e9a9c535ca1801c26da78b0ff465821751a98f921c5cdc5457d7e5a69e9748.js"
          data-service-worker-url="service-worker.js" data-default-locale="en"
          data-asset-version="597e36448c9b51d0fa3b7e43ec1fd6d5" data-disable-custom-css="false"
          data-highlight-js-path="/highlight-js/forum.stackstorm.com/ac0f4aa001e1343346941766d72e0c1ae330832b.js"
          data-svg-sprite-path="/svg-sprite/forum.stackstorm.com/svg-2-c2ad434b1e06079c7e282124aed9938dc95b83ea.js"
          data-enable-js-error-reporting="true" data-color-scheme-is-dark="false" data-user-dark-scheme-id="-1"
          data-s3-cdn="https://aws1.discourse-cdn.com/standard10"
          data-s3-base-url="//discourse-cloud-file-uploads.s3.dualstack.us-west-2.amazonaws.com/standard10">

    <meta name="discourse/config/environment"
          content="%7B%22modulePrefix%22%3A%22discourse%22%2C%22environment%22%3A%22production%22%2C%22rootURL%22%3A%22%22%2C%22locationType%22%3A%22auto%22%2C%22historySupportMiddleware%22%3Afalse%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%2C%22_APPLICATION_TEMPLATE_WRAPPER%22%3Afalse%2C%22_DEFAULT_ASYNC_OBSERVERS%22%3Atrue%2C%22_JQUERY_INTEGRATION%22%3Atrue%7D%2C%22APP%22%3A%7B%22name%22%3A%22discourse%22%2C%22version%22%3A%222.8.0.beta6%20a1daf9fe53a66e2d2cdf9757ab4812fb9a2b2787%22%2C%22exportApplicationGlobal%22%3Atrue%7D%7D"/>
</head>

<body class="">


<header class="d-header">
    <div class="wrap">
        <div class="contents clearfix">
            <div class="title">
                <a href="../../index.html">
                    <picture>
                        <img src="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png"
                             alt="StackStorm Support (ARCHIVED)" id="site-logo"/>
                    </picture>
                </a>
            </div>

        </div>
    </div>
</header>

<div id="main-outlet" class="wrap" role="main">
    <!-- preload-content: -->

    <!-- EOF START -->
    <div class="container" id="main-container">
        <div id="ember11" class="ember-view"></div>
        <div id="ember12" class="controls ember-view"><!----></div>
        <div id="ember13" class="ember-view"><!----></div>
        <div id="ember14" class="ember-view">
            <div class="row">
                <div id="global-notice-alert-read-only" class="alert alert-info alert-read-only">
                    <!----> <span class="text">This site is in read only mode. Please continue to browse, but replying, likes, and other actions are disabled for now.</span>

                    <!---->    </div>
            </div>
            <div class="row">
                <div id="global-notice-alert-global-notice" class="alert alert-info alert-global-notice">
                    <!----> <span class="text"><h3>⚠️ We've moved!</h3>  <p> Hi there!<br><br> To reduce project dependency on 3rd party paid services the StackStorm TSC has decided to move the Q/A from this forum to <a
                        href="https://github.com/StackStorm/st2/discussions">Github Discussions</a>. This will make user experience better integrated with the native Github flow, as well as the questions closer to the community where they can provide answers. </p>  <p> Use 🔗 <b><a
                        href="https://github.com/StackStorm/st2/discussions" class="active">Github Discussions</a></b> to ask your questions. </p></span>

                    <!---->    </div>
            </div>
        </div>
        <div id="ember17" class="hidden create-topics-notice ember-view"><!----></div>
        <!---->
    </div>
    <!-- EOF END -->
    <div id="topic-title">
        <h1>
            <a href="1452.html">Multiple actions in one loop based on the current item</a>
        </h1>

        <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/workflow-related-issues/15" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Workflows</span>
              </span>
            </a>
            <meta itemprop="position" content="1"/>
          </span>
        </div>

        <div class="topic-category">
            <div class='discourse-tags list-tags'>
                <a href='../../tag/orquesta' class='discourse-tag' rel="tag">orquesta</a>,
                <a href='../../tag/workflows' class='discourse-tag' rel="tag">workflows</a>
            </div>
        </div>
    </div>


    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/wingi'><span itemprop='name'>wingi</span></a>
            (Nikolas)
          </span>

            <link itemprop="mainEntityOfPage" href="1452.html">

            <link itemprop="image"
                  href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/bdf7f5f99a3926e7475d9fc40728685cc2096b76.png">

            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-14T10:55:10Z' class='post-time'>
                October 14, 2020, 10:55am
              </time>
              <meta itemprop='dateModified' content='2020-10-14T10:55:10Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Hi,</p>
            <p>what I am trying to do is a workflow that at some point needs to loop over a list of dictionary items. In
                this loop I need to start several actions using values from the current item as input. As the last step
                of one iteration of the loop I want to use all results in an final action.</p>
            <p>I created a picture for better understanding:<br>
            <div class="lightbox-wrapper"><a class="lightbox"
                                             href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/bdf7f5f99a3926e7475d9fc40728685cc2096b76.png"
                                             data-download-href="/uploads/short-url/r6xuIWP8eQRQhCaE4mhoVVkFEfs.png?dl=1"
                                             title="grafik" rel="noopener nofollow ugc"><img
                    src="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/bdf7f5f99a3926e7475d9fc40728685cc2096b76_2_307x499.png"
                    alt="grafik" data-base62-sha1="r6xuIWP8eQRQhCaE4mhoVVkFEfs" width="307" height="499"
                    srcset="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/bdf7f5f99a3926e7475d9fc40728685cc2096b76_2_307x499.png, https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/bdf7f5f99a3926e7475d9fc40728685cc2096b76_2_460x748.png 1.5x, https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/bdf7f5f99a3926e7475d9fc40728685cc2096b76_2_614x998.png 2x"
                    data-small-upload="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/bdf7f5f99a3926e7475d9fc40728685cc2096b76_2_10x10.png">
                <div class="meta">
                    <svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true">
                        <use xlink:href="#far-image"></use>
                    </svg>
                    <span class="filename">grafik</span><span class="informations">904×1468 74.4 KB</span>
                    <svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true">
                        <use xlink:href="#discourse-expand"></use>
                    </svg>
                </div>
            </a></div>
            </p>
            <p>So far I was not able to identify a solution. I tried multiple actions in a with statement but it looks
                like only the last action definition is used.<br>
                Also publishing the current item value and starting another action via next was not possible as the next
                statement is only executed once after all iterations are done.</p>
            <p>Maybe subworkflow might be a solution, but I wanted to ask you for the best approach. It would also be
                nice to have it in one workflow.</p>
            <p>Any idea is appreciated.</p>
            <p>Thanks.</p>
        </div>

        <meta itemprop='headline' content='Multiple actions in one loop based on the current item'>
        <meta itemprop='keywords' content='orquesta, workflows'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/nmaludy'><span itemprop='name'>nmaludy</span></a>
            (Nick Maludy)
          </span>

            <link itemprop="mainEntityOfPage" href="1452.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-14T15:56:28Z' class='post-time'>
                October 14, 2020,  3:56pm
              </time>
              <meta itemprop='dateModified' content='2020-10-14T15:56:28Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p><a class="mention" href="https://github.com/wingi">@wingi</a> You can make another workflow
                with those “several actions” in it, then your main workflow can use <code>with-items</code> to invoke
                that workflow once per item in your dictionary.</p>
            <p>Does this make sense?</p>
        </div>

        <meta itemprop='headline' content='Multiple actions in one loop based on the current item'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/wingi'><span itemprop='name'>wingi</span></a>
            (Nikolas)
          </span>

            <link itemprop="mainEntityOfPage" href="1452.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-20T09:26:41Z' class='post-time'>
                October 20, 2020,  9:26am
              </time>
              <meta itemprop='dateModified' content='2020-10-20T09:26:41Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>yes this works so far. Just wanted to know if there is another possibility as well. There might be some
                use cases where it is easier to have it in one workflow, to use several variables without passing them
                force and back.</p>
        </div>

        <meta itemprop='headline' content='Multiple actions in one loop based on the current item'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/wingi'><span itemprop='name'>wingi</span></a>
            (Nikolas)
          </span>

            <link itemprop="mainEntityOfPage" href="1452.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2020-10-28T17:11:30Z' class='post-time'>
                October 28, 2020,  5:11pm
              </time>
              <meta itemprop='dateModified' content='2020-10-28T17:11:30Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Hi,</p>
            <p>during further development I have a follow-up question.<br>
                How can I go on with the WFL after all loops are done like shown in my flow chart?<br>
                For now the WFL goes on after every iteration of the loop. What I want to achieve is that “other_things”
                and following tasks are only executed once.<br>
                “Join: all” was not working, I can imagine it is because of there are no different branches before.</p>
            <p>My current WFL:</p>
            <pre><code>tasks:
   Loop_over_hosts:
    action: my_pack.subworkflow
    with:
      items: &lt;% ctx().Hosts %&gt;
      concurrency: 1
    input:
      ...
    next:
      - when: &lt;% suceeded %&gt;
        do: other_things


  other_things:
    action: st2.kv.set
    input:
      key: some_key
      value: "foo"</code></pre>
        </div>

        <meta itemprop='headline' content='Multiple actions in one loop based on the current item'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>


    <!-- :preload-content -->
    <footer class="noscript-footer-nav">
        <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
            <a href='../../index.html'>Home</a>
            <a href="../../categories.html">Categories</a>
            <a href="https://forum.stackstorm.com/guidelines">FAQ/Guidelines</a>
            <a href="../../tos.html">Terms of Service</a>
            <a href="../../privacy.html">Privacy Policy</a>
        </nav>
    </footer>
</div>

<footer id='noscript-footer'>
    <p>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>


<section id='main'>
</section>


</body>
</html>
