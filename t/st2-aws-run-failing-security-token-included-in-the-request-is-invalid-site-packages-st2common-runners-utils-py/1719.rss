<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>St2 aws run failing security token included in the request is invalid site-packages/st2common/runners/utils.py</title>
    <link>https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719</link>
    <description>st2 run aws.ec2_get_all_tags
..
id: 60ae1858807900e911ac5045
action.ref: aws.ec2_get_all_tags
context.user: st2admin
parameters: None
status: failed
start_timestamp: Wed, 26 May 2021 09:43:52 UTC
end_timestamp: Wed, 26 May 2021 09:43:55 UTC
result: 
  exit_code: 1
  result: None
  stderr: &quot;Traceback (most recent call last):
  File &quot;/opt/stackstorm/st2/lib/python3.6/site-packages/st2common/runners/utils.py&quot;, line 134, in get_action_class_instance
    action_instance = action_cls(**kwargs)
TypeError: __init__() got an unexpected keyword argument &#39;action_service&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File &quot;/opt/stackstorm/st2/lib/python3.6/site-packages/python_runner/python_action_wrapper.py&quot;, line 334, in &lt;module&gt;
    obj.run()
  File &quot;/opt/stackstorm/st2/lib/python3.6/site-packages/python_runner/python_action_wrapper.py&quot;, line 192, in run
    action = self._get_action_instance()
  File &quot;/opt/stackstorm/st2/lib/python3.6/site-packages/python_runner/python_action_wrapper.py&quot;, line 261, in _get_action_instance
    action_service=action_service)
  File &quot;/opt/stackstorm/st2/lib/python3.6/site-packages/st2common/runners/utils.py&quot;, line 143, in get_action_class_instance
    action_instance = action_cls(**kwargs)
  File &quot;/opt/stackstorm/packs/aws/actions/lib/action.py&quot;, line 67, in __init__
    self.account_id = self.session.client(&#39;sts&#39;).get_caller_identity().get(&#39;Account&#39;)
  File &quot;/opt/stackstorm/virtualenvs/aws/lib/python3.6/site-packages/botocore/client.py&quot;, line 251, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File &quot;/opt/stackstorm/virtualenvs/aws/lib/python3.6/site-packages/botocore/client.py&quot;, line 537, in _make_api_call
    raise ClientError(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (InvalidClientTokenId) when calling the GetCallerIdentity operation: The security token included in the request is invalid.</description>
    
    <lastBuildDate>Thu, 27 May 2021 13:08:52 +0000</lastBuildDate>
    <category>Exchange</category>
    <atom:link href="https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>St2 aws run failing security token included in the request is invalid site-packages/st2common/runners/utils.py</title>
        <dc:creator><![CDATA[raghavendra]]></dc:creator>
        <description><![CDATA[
            <p>st2 execution get 60ae05f2807900e911ac502d<br>
id: 60ae05f2807900e911ac502d<br>
action.ref: aws.ec2_get_all_instances<br>
context.user: st2admin<br>
parameters: None<br>
status: failed (2s elapsed)<br>
start_timestamp: Wed, 26 May 2021 08:25:22 UTC<br>
end_timestamp: Wed, 26 May 2021 08:25:24 UTC<br>
result:<br>
exit_code: 1<br>
result: None<br>
stderr: "Traceback (most recent call last):<br>
File “/opt/stackstorm/st2/lib/python3.6/site-packages/st2common/runners/utils.py”, line 134, in get_action_class_instance<br>
action_instance = action_cls(**kwargs)<br>
TypeError: <strong>init</strong>() got an unexpected keyword argument ‘action_service’</p>
<p>During handling of the above exception, another exception occurred:</p>
<p>Traceback (most recent call last):<br>
File “/opt/stackstorm/st2/lib/python3.6/site-packages/python_runner/python_action_wrapper.py”, line 334, in <br>
obj.run()<br>
File “/opt/stackstorm/st2/lib/python3.6/site-packages/python_runner/python_action_wrapper.py”, line 192, in run<br>
action = self._get_action_instance()<br>
File “/opt/stackstorm/st2/lib/python3.6/site-packages/python_runner/python_action_wrapper.py”, line 261, in _get_action_instance<br>
action_service=action_service)<br>
File “/opt/stackstorm/st2/lib/python3.6/site-packages/st2common/runners/utils.py”, line 143, in get_action_class_instance<br>
action_instance = action_cls(**kwargs)<br>
File “/opt/stackstorm/packs/aws/actions/lib/action.py”, line 67, in <strong>init</strong><br>
self.account_id = self.session.client(‘sts’).get_caller_identity().get(‘Account’)<br>
File “/opt/stackstorm/virtualenvs/aws/lib/python3.6/site-packages/botocore/client.py”, line 251, in _api_call<br>
return self._make_api_call(operation_name, kwargs)<br>
File “/opt/stackstorm/virtualenvs/aws/lib/python3.6/site-packages/botocore/client.py”, line 537, in _make_api_call<br>
raise ClientError(parsed_response, operation_name)<br>
botocore.exceptions.ClientError: An error occurred (InvalidClientTokenId) when calling the GetCallerIdentity operation: The security token included in the request is invalid.</p>
<p>Have checked aws.yaml</p>
<hr>
<p>aws_access_key_id: ***<strong>hgg</strong><br>
aws_secret_access_key: ********<br>
aws_security_token: ‘’<br>
region: us-east-1<br>
debug: true</p>
<p>service_notifications_sensor:<br>
host: localhost<br>
port: 12345<br>
path: /my-path</p>
<p>actions:<br>
roles:<br>
- arn:aws:iam::*****:role/stackstorm_ADMIN_ACCESS</p>
<p>from where it picks yaml file<br>
location of the file /opt/stackstorm/aws.yaml or /opt/stackstorm/pack/aws/aws.yaml</p>
          <p><a href="https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719/3</link>
        <pubDate>Wed, 26 May 2021 17:59:16 +0000</pubDate>
        <guid isPermaLink="false">forum.stackstorm.com-post-1719-3</guid>
        <source url="https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719.rss">St2 aws run failing security token included in the request is invalid site-packages/st2common/runners/utils.py</source>
      </item>
      <item>
        <title>St2 aws run failing security token included in the request is invalid site-packages/st2common/runners/utils.py</title>
        <dc:creator><![CDATA[blag]]></dc:creator>
        <description><![CDATA[
            <p>Check your AWS pack configuration and ensure that the client token that you are using is valid.</p>
<p>Can you run other actions in the AWS pack?</p>
          <p><a href="https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719/2</link>
        <pubDate>Wed, 26 May 2021 17:23:31 +0000</pubDate>
        <guid isPermaLink="false">forum.stackstorm.com-post-1719-2</guid>
        <source url="https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719.rss">St2 aws run failing security token included in the request is invalid site-packages/st2common/runners/utils.py</source>
      </item>
      <item>
        <title>St2 aws run failing security token included in the request is invalid site-packages/st2common/runners/utils.py</title>
        <dc:creator><![CDATA[raghavendra]]></dc:creator>
        <description><![CDATA[
            <p>st2 run aws.ec2_get_all_tags<br>
…<br>
id: 60ae1858807900e911ac5045<br>
action.ref: aws.ec2_get_all_tags<br>
context.user: st2admin<br>
parameters: None<br>
status: failed<br>
start_timestamp: Wed, 26 May 2021 09:43:52 UTC<br>
end_timestamp: Wed, 26 May 2021 09:43:55 UTC<br>
result:<br>
exit_code: 1<br>
result: None<br>
stderr: "Traceback (most recent call last):<br>
File “/opt/stackstorm/st2/lib/python3.6/site-packages/st2common/runners/utils.py”, line 134, in get_action_class_instance<br>
action_instance = action_cls(**kwargs)<br>
TypeError: <strong>init</strong>() got an unexpected keyword argument ‘action_service’</p>
<p>During handling of the above exception, another exception occurred:</p>
<p>Traceback (most recent call last):<br>
File “/opt/stackstorm/st2/lib/python3.6/site-packages/python_runner/python_action_wrapper.py”, line 334, in <br>
obj.run()<br>
File “/opt/stackstorm/st2/lib/python3.6/site-packages/python_runner/python_action_wrapper.py”, line 192, in run<br>
action = self._get_action_instance()<br>
File “/opt/stackstorm/st2/lib/python3.6/site-packages/python_runner/python_action_wrapper.py”, line 261, in _get_action_instance<br>
action_service=action_service)<br>
File “/opt/stackstorm/st2/lib/python3.6/site-packages/st2common/runners/utils.py”, line 143, in get_action_class_instance<br>
action_instance = action_cls(**kwargs)<br>
File “/opt/stackstorm/packs/aws/actions/lib/action.py”, line 67, in <strong>init</strong><br>
self.account_id = self.session.client(‘sts’).get_caller_identity().get(‘Account’)<br>
File “/opt/stackstorm/virtualenvs/aws/lib/python3.6/site-packages/botocore/client.py”, line 251, in _api_call<br>
return self._make_api_call(operation_name, kwargs)<br>
File “/opt/stackstorm/virtualenvs/aws/lib/python3.6/site-packages/botocore/client.py”, line 537, in _make_api_call<br>
raise ClientError(parsed_response, operation_name)<br>
botocore.exceptions.ClientError: An error occurred (InvalidClientTokenId) when calling the GetCallerIdentity operation: The security token included in the request is invalid.</p>
          <p><a href="https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719/1</link>
        <pubDate>Wed, 26 May 2021 10:01:13 +0000</pubDate>
        <guid isPermaLink="false">forum.stackstorm.com-post-1719-1</guid>
        <source url="https://forum.stackstorm.com/t/st2-aws-run-failing-security-token-included-in-the-request-is-invalid-site-packages-st2common-runners-utils-py/1719.rss">St2 aws run failing security token included in the request is invalid site-packages/st2common/runners/utils.py</source>
      </item>
  </channel>
</rss>
