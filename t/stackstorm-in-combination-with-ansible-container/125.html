<!DOCTYPE html>
<html lang="en" class="desktop-view not-mobile-device text-size-normal anon">
<head>
    <meta charset="utf-8">
    <title>Stackstorm in combination with ansible-container - Operations - StackStorm Support (ARCHIVED)</title>
    <meta name="description" content="Hi! 
I‚Äôm a big fan of both ansible and stackstorm. Have been able to setup a working stackstorm system using ansible-container, st2 version 2.3 . But now when I try to use version 2.7 mistral stopped working. Everything &amp;hellip;">
    <meta name="discourse_theme_id" content="2">
    <meta name="discourse_current_homepage" content="latest">
    <meta name="generator"
          content="Discourse 2.8.0.beta6 - https://github.com/discourse/discourse version a1daf9fe53a66e2d2cdf9757ab4812fb9a2b2787">
    <link rel="icon" type="image/png"
          href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/379ced12f8326d58f1b3d2b3ff652f883e141f6a_2_32x32.PNG">
    <link rel="apple-touch-icon" type="image/png"
          href="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/optimized/1X/379ced12f8326d58f1b3d2b3ff652f883e141f6a_2_180x180.PNG">
    <meta name="theme-color" content="#ffffff">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <link rel="canonical" href="125.html"/>
    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "https://forum.stackstorm.com",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://forum.stackstorm.com/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    <link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml"
          title="StackStorm Support (ARCHIVED) Search">


    <link href="https://sjc6.discourse-cdn.com/standard10/stylesheets/color_definitions_basis__2_3c5eec1ecf192052ea70b4afdab57a62bccc0604.css?__ws=forum.stackstorm.com"
          media="all" rel="stylesheet" class="light-scheme"/>

    <link href="/../../stylesheets/desktop_b2f2968742d41481357e0df259b51ce29f72481a.css?__ws=forum.stackstorm.com"
          media="all" rel="stylesheet" data-target="desktop"/>


    <meta name="fragment" content="!">


    <link id="manifest-link" rel="manifest" href="../../manifest.webmanifest" crossorigin="use-credentials">


    <link rel="alternate" type="application/rss+xml"
          title="RSS feed of &#39;Stackstorm in combination with ansible-container&#39;" href="125.rss"/>
    <meta property="og:site_name" content="StackStorm Support (ARCHIVED)"/>
    <meta property="og:type" content="website"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image"
          content="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/891f00fbdb31fecb5bd9dab30c186d2fed0091ca.jpeg"/>
    <meta property="og:image"
          content="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/891f00fbdb31fecb5bd9dab30c186d2fed0091ca.jpeg"/>
    <meta property="og:url"
          content="https://forum.stackstorm.com/t/stackstorm-in-combination-with-ansible-container/125"/>
    <meta name="twitter:url"
          content="https://forum.stackstorm.com/t/stackstorm-in-combination-with-ansible-container/125"/>
    <meta property="og:title" content="Stackstorm in combination with ansible-container"/>
    <meta name="twitter:title" content="Stackstorm in combination with ansible-container"/>
    <meta property="og:description"
          content="Hi!  I‚Äôm a big fan of both ansible and stackstorm. Have been able to setup a working stackstorm system using ansible-container, st2 version 2.3 . But now when I try to use version 2.7 mistral stopped working. Everything seem to be working except the mistral part.  And it‚Äôs looks like it has something to do with the mistral authentication. Don‚Äôt know how to move forward from here. Anyone that can help me or point me in the correct direction?  Self-check output:   /opt/stackstorm/st2/bin/st2-self-..."/>
    <meta name="twitter:description"
          content="Hi!  I‚Äôm a big fan of both ansible and stackstorm. Have been able to setup a working stackstorm system using ansible-container, st2 version 2.3 . But now when I try to use version 2.7 mistral stopped working. Everything seem to be working except the mistral part.  And it‚Äôs looks like it has something to do with the mistral authentication. Don‚Äôt know how to move forward from here. Anyone that can help me or point me in the correct direction?  Self-check output:   /opt/stackstorm/st2/bin/st2-self-..."/>
    <meta property="article:published_time" content="2018-04-24T14:43:01+00:00"/>
    <meta property="og:ignore_canonical" content="true"/>


    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "QAPage",
        "name": "Stackstorm in combination with ansible-container",
        "mainEntity": {
            "@type": "Question",
            "name": "Stackstorm in combination with ansible-container",
            "text": "Hi!\n\nI‚Äôm a big fan of both ansible and stackstorm. Have been able to setup a working stackstorm system using <a href="
            https://forum.stackstorm.com/t/stackstorm-in-combination-with-ansible-container/\&quot;https://www.ansible.com/integrations/containers/ansible-container\&quot;" rel=\"nofollow noopener\">ansible-container<\/a>, st2 version 2.3 . But now when I try to use version 2.7 mistral stopped working. Everything seem to be working except the mistral part.  And it‚Äôs looks like it has somethin&hellip;","upvoteCount":0,"answerCount":1,"dateCreated":"2018-04-24T14:43:01.333Z","author":{"@type":"Person","name":"Patrik Smeds"},"acceptedAnswer":{"@type":"Answer","text":"I found the cause of my problem. It‚Äôs a dns lookup problem, with ansibe-container I can‚Äôt set ‚Äúdns_search: .‚Äù  which is set in the docker-compose file. Mistral is trying to do a lookup using the name of my container and that fails.","upvoteCount":0,"dateCreated":"2018-04-26T12:31:08.016Z","url":"https://forum.stackstorm.com/t/stackstorm-in-combination-with-ansible-container/125/5","author":{"@type":"Person","name":"smeds"}}}}
    </script>

    <meta id="data-discourse-setup" data-cdn="https://sjc6.discourse-cdn.com/standard10"
          data-base-url="https://forum.stackstorm.com" data-base-uri="" data-environment="production"
          data-letter-avatar-version="5_8fec8e114563efeaf5265573e510f08e"
          data-markdown-it-url="https://aws1.discourse-cdn.com/standard10/assets/markdown-it-bundle-31e9a9c535ca1801c26da78b0ff465821751a98f921c5cdc5457d7e5a69e9748.js"
          data-service-worker-url="service-worker.js" data-default-locale="en"
          data-asset-version="597e36448c9b51d0fa3b7e43ec1fd6d5" data-disable-custom-css="false"
          data-highlight-js-path="/highlight-js/forum.stackstorm.com/ac0f4aa001e1343346941766d72e0c1ae330832b.js"
          data-svg-sprite-path="/svg-sprite/forum.stackstorm.com/svg-2-c2ad434b1e06079c7e282124aed9938dc95b83ea.js"
          data-enable-js-error-reporting="true" data-color-scheme-is-dark="false" data-user-dark-scheme-id="-1"
          data-s3-cdn="https://aws1.discourse-cdn.com/standard10"
          data-s3-base-url="//discourse-cloud-file-uploads.s3.dualstack.us-west-2.amazonaws.com/standard10">

    <meta name="discourse/config/environment"
          content="%7B%22modulePrefix%22%3A%22discourse%22%2C%22environment%22%3A%22production%22%2C%22rootURL%22%3A%22%22%2C%22locationType%22%3A%22auto%22%2C%22historySupportMiddleware%22%3Afalse%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%2C%22_APPLICATION_TEMPLATE_WRAPPER%22%3Afalse%2C%22_DEFAULT_ASYNC_OBSERVERS%22%3Atrue%2C%22_JQUERY_INTEGRATION%22%3Atrue%7D%2C%22APP%22%3A%7B%22name%22%3A%22discourse%22%2C%22version%22%3A%222.8.0.beta6%20a1daf9fe53a66e2d2cdf9757ab4812fb9a2b2787%22%2C%22exportApplicationGlobal%22%3Atrue%7D%7D"/>
</head>

<body class="">


<header class="d-header">
    <div class="wrap">
        <div class="contents clearfix">
            <div class="title">
                <a href="../../index.html">
                    <picture>
                        <img src="https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png"
                             alt="StackStorm Support (ARCHIVED)" id="site-logo"/>
                    </picture>
                </a>
            </div>

        </div>
    </div>
</header>

<div id="main-outlet" class="wrap" role="main">
    <!-- preload-content: -->

    <!-- EOF START -->
    <div class="container" id="main-container">
        <div id="ember11" class="ember-view"></div>
        <div id="ember12" class="controls ember-view"><!----></div>
        <div id="ember13" class="ember-view"><!----></div>
        <div id="ember14" class="ember-view">
            <div class="row">
                <div id="global-notice-alert-read-only" class="alert alert-info alert-read-only">
                    <!----> <span class="text">This site is in read only mode. Please continue to browse, but replying, likes, and other actions are disabled for now.</span>

                    <!---->    </div>
            </div>
            <div class="row">
                <div id="global-notice-alert-global-notice" class="alert alert-info alert-global-notice">
                    <!----> <span class="text"><h3>‚ö†Ô∏è We've moved!</h3>  <p> Hi there!<br><br> To reduce project dependency on 3rd party paid services the StackStorm TSC has decided to move the Q/A from this forum to <a
                        href="https://github.com/StackStorm/st2/discussions">Github Discussions</a>. This will make user experience better integrated with the native Github flow, as well as the questions closer to the community where they can provide answers. </p>  <p> Use üîó <b><a
                        href="https://github.com/StackStorm/st2/discussions" class="active">Github Discussions</a></b> to ask your questions. </p></span>

                    <!---->    </div>
            </div>
        </div>
        <div id="ember17" class="hidden create-topics-notice ember-view"><!----></div>
        <!---->
    </div>
    <!-- EOF END -->
    <div id="topic-title">
        <h1>
            <a href="125.html">Stackstorm in combination with ansible-container</a>
        </h1>

        <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/operations-related-issues/20" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #283890'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Operations</span>
              </span>
            </a>
            <meta itemprop="position" content="1"/>
          </span>
        </div>

        <div class="topic-category">
            <div class='discourse-tags list-tags'>
                <a href='../../tag/docker' class='discourse-tag' rel="tag">docker</a>,
                <a href='../../tag/ansible' class='discourse-tag' rel="tag">ansible</a>
            </div>
        </div>
    </div>


    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/smeds'><span itemprop='name'>smeds</span></a>
            (Patrik Smeds)
          </span>

            <link itemprop="mainEntityOfPage" href="125.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-04-24T14:43:01Z' class='post-time'>
                April 24, 2018,  2:43pm
              </time>
              <meta itemprop='dateModified' content='2018-05-15T19:35:26Z'>
          <span itemprop='position'>#1</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Hi!</p>
            <p>I‚Äôm a big fan of both ansible and stackstorm. Have been able to setup a working stackstorm system using
                <a href="https://www.ansible.com/integrations/containers/ansible-container" rel="nofollow noopener">ansible-container</a>,
                st2 version 2.3 . But now when I try to use version 2.7 mistral stopped working. Everything seem to be
                working except the mistral part. And it‚Äôs looks like it has something to do with the mistral
                authentication. Don‚Äôt know how to move forward from here. Anyone that can help me or point me in the
                correct direction?</p>
            <p>Self-check output:</p>
            <blockquote>
                <p>/opt/stackstorm/st2/bin/st2-self-check<br>
                    Attempting Test tests.test_inquiry_chain‚Ä¶OK!<br>
                    Attempting Test tests.test_inquiry_mistral‚Ä¶ERROR!<br>
                    Attempting Test tests.test_key_triggers‚Ä¶OK!<br>
                    Attempting Test tests.test_packs_pack‚Ä¶OK!<br>
                    Attempting Test tests.test_quickstart‚Ä¶ERROR!<br>
                    Attempting Test tests.test_quickstart_key‚Ä¶OK!<br>
                    Attempting Test tests.test_quickstart_local_script_actions‚Ä¶OK!<br>
                    Attempting Test tests.test_quickstart_passive_sensor‚Ä¶OK!<br>
                    Attempting Test tests.test_quickstart_polling_sensor‚Ä¶OK!<br>
                    Attempting Test tests.test_quickstart_python_actions‚Ä¶OK!<br>
                    Attempting Test tests.test_quickstart_remote_script_actions‚Ä¶ERROR!<br>
                    Attempting Test tests.test_quickstart_rules‚Ä¶OK!<br>
                    Attempting Test tests.test_quickstart_trace‚Ä¶OK!<br>
                    Attempting Test tests.test_run_pack_tests_tool‚Ä¶OK!<br>
                    Attempting Test tests.test_timer_rule‚Ä¶OK!<br>
                    Skipping tests.test_windows_runners‚Ä¶<br>
                    Attempting Example examples.mistral_examples‚Ä¶ERROR!<br>
                    SELF CHECK FAILED!</p>
            </blockquote>
            <p>Output from examples-mistral_examples</p>
            <blockquote>
                <p>id: 5adf3fa3585f530a3ff4f190<br>
                    action.ref: examples.mistral_examples<br>
                    parameters: None<br>
                    status: failed (32s elapsed)<br>
                    result_task: mistral-basic<br>
                    result:<br>
                    error: ‚Äò1‚Äô<br>
                    traceback: " File
                    ‚Äú/opt/stackstorm/st2/local/lib/python2.7/site-packages/st2actions/container/base.py‚Äù, line 119, in
                    _do_run<br>
                    (status, result, context) = runner.run(action_params)<br>
                    File ‚Äú/opt/stackstorm/st2/local/lib/python2.7/site-packages/retrying.py‚Äù, line 49, in wrapped_f<br>
                    return Retrying(*dargs, **dkw).call(f, *args, **kw)<br>
                    File ‚Äú/opt/stackstorm/st2/local/lib/python2.7/site-packages/retrying.py‚Äù, line 206, in call<br>
                    return attempt.get(self._wrap_exception)<br>
                    File ‚Äú/opt/stackstorm/st2/local/lib/python2.7/site-packages/retrying.py‚Äù, line 247, in get<br>
                    six.reraise(self.value[0], self.value[1], self.value[2])<br>
                    File ‚Äú/opt/stackstorm/st2/local/lib/python2.7/site-packages/retrying.py‚Äù, line 200, in call<br>
                    attempt = Attempt(fn(*args, **kwargs), attempt_number, False)<br>
                    File ‚Äú/opt/stackstorm/runners/mistral_v2/mistral_v2/mistral_v2.py‚Äù, line 247, in run<br>
                    result = self.start_workflow(action_parameters=action_parameters)<br>
                    File ‚Äú/opt/stackstorm/runners/mistral_v2/mistral_v2/mistral_v2.py‚Äù, line 289, in start_workflow<br>
                    **options)<br>
                    File ‚Äú/opt/stackstorm/st2/local/lib/python2.7/site-packages/mistralclient/api/v2/executions.py‚Äù,
                    line 65, in create<br>
                    return self._create(‚Äô/executions‚Äô, data)<br>
                    File ‚Äú/opt/stackstorm/st2/local/lib/python2.7/site-packages/mistralclient/api/base.py‚Äù, line 100, in
                    _create<br>
                    self._raise_api_exception(resp)<br>
                    File ‚Äú/opt/stackstorm/st2/local/lib/python2.7/site-packages/mistralclient/api/base.py‚Äù, line 160, in
                    _raise_api_exception<br>
                    error_message=error_data)<br>
                    "</p>
            </blockquote>
            <p>Running tests.test_inquiry_mistral manually result in the following output:</p>
            <blockquote>
                <p>id: 5adf4105585f530a3ff4f195<br>
                    action.ref: tests.test_inquiry_mistral<br>
                    parameters: None<br>
                    status: failed (2s elapsed)<br>
                    result_task: execute_inquiry_workflow<br>
                    result:<br>
                    failed: true<br>
                    return_code: 1<br>
                    stderr: ‚Äò‚Äô<br>
                    stdout: 'ERROR: 401 Client Error: Unauthorized<br>
                    MESSAGE: Unauthorized - One of Token or API key required. for url: <a
                            href="http://127.0.0.1:9101/actions/examples.mistral-ask-basic" rel="nofollow noopener">http://127.0.0.1:9101/actions/examples.mistral-ask-basic</a><br>
                    ‚Äô<br>
                    succeeded: false<br>
                    start_timestamp: Tue, 24 Apr 2018 14:36:53 UTC<br>
                    end_timestamp: Tue, 24 Apr 2018 14:36:55 UTC<br>
                    ¬±-------------------------¬±--------------------¬±-------------------------¬±-----------¬±------------------------------+<br>
                    | id | status | task | action | start_timestamp |<br>
                    ¬±-------------------------¬±--------------------¬±-------------------------¬±-----------¬±------------------------------+<br>
                    | 5adf4106585f530a12e4313c | failed (1s elapsed) | execute_inquiry_workflow | core.local | Tue, 24
                    Apr 2018 14:36:54 UTC |<br>
                    ¬±-------------------------¬±--------------------¬±-------------------------¬±-----------¬±------------------------------+
                </p>
            </blockquote>
            <p>Trying to run mistral manually:</p>
            <blockquote>
                <p>mistral --debug -v run-action std.echo ‚Äò{‚Äúoutput‚Äù: ‚ÄúHello‚Äù}‚Äô<br>
                    DEBUG (extension) found extension EntryPoint.parse(‚Äòtable =
                    cliff.formatters.table:TableFormatter‚Äô)<br>
                    DEBUG (extension) found extension EntryPoint.parse(‚Äòjson =
                    cliff.formatters.json_format:JSONFormatter‚Äô)<br>
                    DEBUG (extension) found extension EntryPoint.parse(‚Äòshell =
                    cliff.formatters.shell:ShellFormatter‚Äô)<br>
                    DEBUG (extension) found extension EntryPoint.parse(‚Äòvalue =
                    cliff.formatters.value:ValueFormatter‚Äô)<br>
                    DEBUG (extension) found extension EntryPoint.parse(‚Äòyaml =
                    cliff.formatters.yaml_format:YAMLFormatter‚Äô)<br>
                    DEBUG (command) run(Namespace(columns=[], fit_width=False, formatter=‚Äòtable‚Äô, input=‚Äô{‚Äúoutput‚Äù:
                    ‚ÄúHello‚Äù}‚Äô, max_width=0, name=‚Äòstd.echo‚Äô, noindent=False, prefix=‚Äô‚Äô, print_empty=False,
                    run_sync=False, save_result=False, target=None, variables=[]))<br>
                    DEBUG (connectionpool) Starting new HTTP connection (1): 127.0.0.1<br>
                    DEBUG (connectionpool) <a href="http://127.0.0.1:8989"
                                              rel="nofollow noopener">http://127.0.0.1:8989</a> ‚ÄúPOST
                    /v2/action_executions HTTP/1.1‚Äù 500 62<br>
                    DEBUG (httpclient) HTTP POST <a href="http://127.0.0.1:8989/v2/action_executions"
                                                    rel="nofollow noopener">http://127.0.0.1:8989/v2/action_executions</a>
                    500<br>
                    ERROR (app) 1<br>
                    Traceback (most recent call last):<br>
                    File ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/cliff/app.py‚Äù, line 400, in
                    run_subcommand<br>
                    result = cmd.run(parsed_args)<br>
                    File ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/osc_lib/command/command.py‚Äù, line
                    41, in run<br>
                    return super(Command, self).run(parsed_args)<br>
                    File ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/cliff/display.py‚Äù, line 116, in
                    run<br>
                    column_names, data = self.take_action(parsed_args)<br>
                    File
                    ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/mistralclient/commands/v2/action_executions.py‚Äù,
                    line 165, in take_action<br>
                    **params<br>
                    File
                    ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/mistralclient/api/v2/action_executions.py‚Äù,
                    line 47, in create<br>
                    self._raise_api_exception(resp)<br>
                    File ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/mistralclient/api/base.py‚Äù, line
                    160, in _raise_api_exception<br>
                    error_message=error_data)<br>
                    APIException: 1<br>
                    Traceback (most recent call last):<br>
                    File ‚Äú/opt/stackstorm/mistral/bin/mistral‚Äù, line 10, in <br>
                    sys.exit(main())<br>
                    File ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/mistralclient/shell.py‚Äù, line 767,
                    in main<br>
                    return MistralShell().run(argv)<br>
                    File ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/cliff/app.py‚Äù, line 279, in run<br>
                    result = self.run_subcommand(remainder)<br>
                    File ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/cliff/app.py‚Äù, line 400, in
                    run_subcommand<br>
                    result = cmd.run(parsed_args)<br>
                    File ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/osc_lib/command/command.py‚Äù, line
                    41, in run<br>
                    return super(Command, self).run(parsed_args)<br>
                    File ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/cliff/display.py‚Äù, line 116, in
                    run<br>
                    column_names, data = self.take_action(parsed_args)<br>
                    File
                    ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/mistralclient/commands/v2/action_executions.py‚Äù,
                    line 165, in take_action<br>
                    **params<br>
                    File
                    ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/mistralclient/api/v2/action_executions.py‚Äù,
                    line 47, in create<br>
                    self._raise_api_exception(resp)<br>
                    File ‚Äú/opt/stackstorm/mistral/local/lib/python2.7/site-packages/mistralclient/api/base.py‚Äù, line
                    160, in _raise_api_exception<br>
                    error_message=error_data)<br>
                    mistralclient.api.base.APIException: 1</p>
            </blockquote>
            <p>If anyone is wondering why I‚Äôm not just using docker-compose, which would be much simpler. It‚Äôs because I
                want to use ansible roles to configure my pack settings depending on which system I am deploying it to
                just using ansible var-files. Also I can encrypt my password.</p>
            <p>My container.yaml if anyone is interested</p>
            <blockquote>
                <p>version: ‚Äú2‚Äù<br>
                    defaults:<br>
                    BASE_IMAGE: grossws/centos<br>
                    BASE_IMAGE_VERSION: 7<br>
                    MONGO_VERSION: 3.4<br>
                    MONGO_HOST: mongo<br>
                    MONGO_PORT: 27017<br>
                    MONGO_DB: st2_db<br>
                    POSTGRES_VERSION: 9.6<br>
                    POSTGRES_HOST: postgres<br>
                    POSTGRES_PORT: 5432<br>
                    POSTGRES_DB: mistral<br>
                    RABBITMQ_VERSION: 3.6-management<br>
                    RABBITMQ_HOST: rabbitmq<br>
                    RABBITMQ_PORT: 5672<br>
                    REDIS_VERSION: 4.0<br>
                    REDIS_HOST: redis<br>
                    REDIS_PORT: 6379<br>
                    ST2_VERSION: 2.7.0</p>
                <p>settings:<br>
                    conductor:<br>
                    base: centos:7</p>
                <p>project_name: test</p>
                <p>services:<br>
                    mongo:<br>
                    from: mongo:3.4<br>
                    volumes:<br>
                    - /data/configdb<br>
                    - mongo-volume:/data/db<br>
                    environment:<br>
                    - MONGO_HOST=mongo<br>
                    - MONGO_PORT=27017</p>
                <p>rabbitmq:<br>
                    from: ‚Äòrabbitmq:{{ RABBITMQ_VERSION }}‚Äô<br>
                    volumes:<br>
                    - rabbitmq-volume:/var/lib/rabbitmq<br>
                    environment:<br>
                    - RABBITMQ_DEFAULT_USER=admin<br>
                    - RABBITMQ_DEFAULT_PASS=mistral-user<br>
                    - RABBITMQ_HOST=rabbitmq<br>
                    - RABBITMQ_PORT=5672</p>
                <p>postgres:<br>
                    from: ‚Äòpostgres:{{ POSTGRES_VERSION }}‚Äô<br>
                    volumes:<br>
                    - postgres-volume:/var/lib/postgresql/data<br>
                    environment:<br>
                    - POSTGRES_USER=mistral-user<br>
                    - POSTGRES_PASSWORD=mistral-user<br>
                    - POSTGRES_HOST=postgres<br>
                    - POSTGRES_PORT=5432<br>
                    - POSTGRES_DB=mistral<br>
                    redis:<br>
                    from: ‚Äòredis:{{ REDIS_VERSION }}‚Äô<br>
                    volumes:<br>
                    - redis-volume:/data<br>
                    environment:<br>
                    - REDIS_PASSWORD=redis_pass<br>
                    - REDIS_HOST=redis<br>
                    - REDIS_PORT=6379<br>
                    command: [<br>
                    ‚Äúbash‚Äù, ‚Äú-c‚Äù,<br>
                    ‚Äô<br>
                    docker-entrypoint.sh<br>
                    ‚Äìrequirepass ‚Äúredis_pass‚Äù<br>
                    ‚Äô<br>
                    ]<br>
                    stackstorm:<br>
                    from: ‚Äústackstorm/stackstorm:{{ ST2_VERSION }}‚Äù<br>
                    priviliged: True<br>
                    volumes:<br>
                    - /home/user/workspace/test/packs.dev:/opt/stackstorm/packs.dev<br>
                    - /home/user/workspace/st2-docker/runtime/entrypoint.d:/st2-docker/entrypoint.d<br>
                    - /home/user/workspace/workspace/st2-docker/runtime/st2.d:/st2-docker/st2.d<br>
                    - /home/user/workspace/workspace/st2-docker/conf/stackstorm.env:/st2-docker/env<br>
                    - stackstorm-volume:/var/log<br>
                    ports: # Make sure that the web interface isn‚Äôt accessible, until we have verified that we can have
                    it.<br>
                    - ‚Äú443:4443‚Äù<br>
                    - ‚Äú80:8080‚Äù<br>
                    environment:<br>
                    - MONGO_HOST=mongo<br>
                    - MONGO_PORT=27017<br>
                    - RABBITMQ_DEFAULT_USER=admin<br>
                    - RABBITMQ_DEFAULT_PASS=mistral-user<br>
                    - RABBITMQ_HOST=rabbitmq<br>
                    - RABBITMQ_PORT=5672<br>
                    - POSTGRES_USER=mistral-user<br>
                    - POSTGRES_PASSWORD=mistral-user<br>
                    - POSTGRES_HOST=postgres<br>
                    - POSTGRES_PORT=5432<br>
                    - POSTGRES_DB=mistral<br>
                    - REDIS_PASSWORD= redis_pass<br>
                    - REDIS_HOST=redis<br>
                    - REDIS_PORT=6379<br>
                    - ST2_USER=st2admin<br>
                    - ST2_PASSWORD=H8WHTIFe</p>
                <p>registries: {}</p>
                <p>volumes:<br>
                    mongo-volume:<br>
                    docker: {}<br>
                    rabbitmq-volume:<br>
                    docker: {}<br>
                    postgres-volume:<br>
                    docker: {}<br>
                    redis-volume:<br>
                    docker: {}<br>
                    stackstorm-volume:<br>
                    docker: {}</p>
            </blockquote>
        </div>

        <meta itemprop='headline' content='Stackstorm in combination with ansible-container'>
        <meta itemprop='keywords' content='docker, ansible'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/warrenvw'><span itemprop='name'>warrenvw</span></a>
            (Warren)
          </span>

            <link itemprop="mainEntityOfPage" href="125.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-04-24T21:15:44Z' class='post-time'>
                April 24, 2018,  9:15pm
              </time>
              <meta itemprop='dateModified' content='2018-04-24T21:15:44Z'>
          <span itemprop='position'>#2</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Hi <a class="mention" href="https://github.com/smeds">@smeds</a> !</p>
            <p>This may be a red herring, but I‚Äôd appreciate if you would confirm whether [coordination] url begins with
                ‚Äúredis://:‚Äù in /etc/st2/st2.conf?</p>
            <p>See <a href="https://github.com/StackStorm/st2-docker/issues/83" rel="nofollow noopener">mistral doesn't
                work in Swarm mode ¬∑ Issue #83 ¬∑ StackStorm/st2-docker ¬∑ GitHub</a> for more detail. Your issue may be
                related.</p>
        </div>

        <meta itemprop='headline' content='Stackstorm in combination with ansible-container'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/smeds'><span itemprop='name'>smeds</span></a>
            (Patrik Smeds)
          </span>

            <link itemprop="mainEntityOfPage" href="125.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-04-25T14:50:22Z' class='post-time'>
                April 25, 2018,  2:50pm
              </time>
              <meta itemprop='dateModified' content='2018-04-25T14:50:22Z'>
          <span itemprop='position'>#3</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Yes it does.</p>
            <p>Here‚Äôs my st2.conf gile:</p>
            <blockquote>
                <p><span class="hashtag">#System-wide</span> configuration</p>
                <p>[api]<br>
                    <span class="hashtag">#Host</span> and port to bind the API server.<br>
                    host = 127.0.0.1<br>
                    port = 9101<br>
                    logging = /etc/st2/logging.api.conf<br>
                    mask_secrets = True<br>
                    <span class="hashtag">#allow_origin</span> is required for handling CORS in st2 web UI.<br>
                    <span class="hashtag">#allow_origin</span> = <a href="http://myhost1.example.com:3000"
                                                                    rel="nofollow noopener">http://myhost1.example.com:3000</a>,<a
                            href="http://myhost2.example.com:3000" rel="nofollow noopener">http://myhost2.example.com:3000</a>
                </p>
                <p>[stream]<br>
                    logging = /etc/st2/logging.stream.conf</p>
                <p>[sensorcontainer]<br>
                    logging = /etc/st2/logging.sensorcontainer.conf</p>
                <p>[rulesengine]<br>
                    logging = /etc/st2/logging.rulesengine.conf</p>
                <p>[actionrunner]<br>
                    logging = /etc/st2/logging.actionrunner.conf<br>
                    virtualenv_opts = --always-copy</p>
                <p>[resultstracker]<br>
                    logging = /etc/st2/logging.resultstracker.conf</p>
                <p>[notifier]<br>
                    logging = /etc/st2/logging.notifier.conf</p>
                <p>[exporter]<br>
                    logging = /etc/st2/logging.exporter.conf</p>
                <p>[garbagecollector]<br>
                    logging = /etc/st2/logging.garbagecollector.conf</p>
                <p>[auth]<br>
                    host = 127.0.0.1<br>
                    port = 9100<br>
                    use_ssl = False<br>
                    debug = False<br>
                    enable = True<br>
                    logging = /etc/st2/logging.auth.conf</p>
                <p>mode = standalone</p>
                <p><span class="hashtag">#Note:</span> Settings below are only used in ‚Äústandalone‚Äù mode<br>
                    backend = flat_file<br>
                    backend_kwargs = {‚Äúfile_path‚Äù: ‚Äú/etc/st2/htpasswd‚Äù}</p>
                <p><span class="hashtag">#Base</span> URL to the API endpoint excluding the version (e.g. <a
                        href="http://myhost.net:9101/" rel="nofollow noopener">http://myhost.net:9101/</a>)<br>
                    api_url =http://127.0.0.1:9101</p>
                <p>[system]<br>
                    base_path = /opt/stackstorm</p>
                <p>[webui]<br>
                    <span class="hashtag">#webui_base_url</span> = <a href="https://mywebhost.domain"
                                                                      rel="nofollow noopener">https://mywebhost.domain</a>
                </p>
                <p>[syslog]<br>
                    host = 127.0.0.1<br>
                    port = 514<br>
                    facility = local7<br>
                    protocol = udp</p>
                <p>[log]<br>
                    excludes = requests,paramiko<br>
                    redirect_stderr = False<br>
                    mask_secrets = True</p>
                <p>[system_user]<br>
                    user = stanley<br>
                    ssh_key_file = /home/stanley/.ssh/stanley_rsa</p>
                <p>[messaging]<br>
                    url = amqp://admin:mistral-user@rabbitmq:5672</p>
                <p>[ssh_runner]<br>
                    remote_dir = /tmp</p>
                <p>[keyvalue]<br>
                    encryption_key_path = /etc/st2/keys/datastore_key.json</p>
                <p>[mistral]<br>
                    api_url = <a href="http://127.0.0.1:9101" rel="nofollow noopener">http://127.0.0.1:9101</a><br>
                    v2_base_url = <a href="http://127.0.0.1:8989/v2"
                                     rel="nofollow noopener">http://127.0.0.1:8989/v2</a></p>
                <p>[coordination]<br>
                    url = redis://:redis_pass@redis:6379</p>
                <p>[database]<br>
                    host = mongo<br>
                    port = 27017</p>
                <p>[content]<br>
                    packs_base_paths = /opt/stackstorm/packs.dev</p>
            </blockquote>
        </div>

        <meta itemprop='headline' content='Stackstorm in combination with ansible-container'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="1"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/smeds'><span itemprop='name'>smeds</span></a>
            (Patrik Smeds)
          </span>

            <link itemprop="mainEntityOfPage" href="125.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-04-26T08:06:56Z' class='post-time'>
                April 26, 2018,  8:06am
              </time>
              <meta itemprop='dateModified' content='2018-04-26T08:06:56Z'>
          <span itemprop='position'>#4</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>Could it be a mistral configuration that I‚Äôm missing? What kind of authentication do I need to setup for
                mistral to work? Everything except executing workflows seem to work.</p>
        </div>

        <meta itemprop='headline' content='Stackstorm in combination with ansible-container'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>
    <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
        <div class='crawler-post-meta'>
            <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
                <meta itemprop='name' content='StackStorm'>
                <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
                    <meta itemprop='url'
                          content='https://aws1.discourse-cdn.com/standard10/uploads/stackstorm/original/1X/843840296d4160717941c20e214d0772ce899ab0.png'>
                </div>
            </div>
            <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a itemprop="url" href='https://github.com/smeds'><span itemprop='name'>smeds</span></a>
            (Patrik Smeds)
          </span>

            <link itemprop="mainEntityOfPage" href="125.html">


            <span class="crawler-post-infos">
              <time itemprop='datePublished' datetime='2018-04-26T12:31:08Z' class='post-time'>
                April 26, 2018, 12:31pm
              </time>
              <meta itemprop='dateModified' content='2018-04-26T12:31:08Z'>
          <span itemprop='position'>#5</span>
          </span>
        </div>
        <div class='post' itemprop='articleBody'>
            <p>I found the cause of my problem. It‚Äôs a dns lookup problem, with ansibe-container I can‚Äôt set
                ‚Äúdns_search: .‚Äù which is set in the docker-compose file. Mistral is trying to do a lookup using the name
                of my container and that fails.</p>
        </div>

        <meta itemprop='headline' content='Stackstorm in combination with ansible-container'>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
            <span class='post-likes'></span>
        </div>

        <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
            <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
            <meta itemprop="userInteractionCount" content="0"/>
        </div>

    </div>


    <!-- :preload-content -->
    <footer class="noscript-footer-nav">
        <nav itemscope itemtype='http://schema.org/SiteNavigationElement'>
            <a href='../../index.html'>Home</a>
            <a href="../../categories.html">Categories</a>
            <a href="https://forum.stackstorm.com/guidelines">FAQ/Guidelines</a>
            <a href="../../tos.html">Terms of Service</a>
            <a href="../../privacy.html">Privacy Policy</a>
        </nav>
    </footer>
</div>

<footer id='noscript-footer'>
    <p>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>


<section id='main'>
</section>


</body>
</html>
